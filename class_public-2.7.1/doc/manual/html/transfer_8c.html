<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CLASS MANUAL: transfer.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CLASS MANUAL
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('transfer_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">transfer.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="transfer_8h_source.html">transfer.h</a>&quot;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for transfer.c:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="transfer_8c__incl.png" border="0" usemap="#transfer_8c" alt=""/></div>
<map name="transfer_8c" id="transfer_8c">
<area shape="rect" id="node2" href="transfer_8h.html" title="transfer.h" alt="" coords="682,79,759,104"/>
<area shape="rect" id="node3" href="nonlinear_8h.html" title="nonlinear.h" alt="" coords="506,152,593,177"/>
<area shape="rect" id="node24" href="hyperspherical_8h_source.html" title="hyperspherical.h" alt="" coords="641,225,760,251"/>
<area shape="rect" id="node4" href="primordial_8h.html" title="primordial.h" alt="" coords="480,225,571,251"/>
<area shape="rect" id="node5" href="perturbations_8h.html" title="perturbations.h" alt="" coords="457,299,567,324"/>
<area shape="rect" id="node6" href="thermodynamics_8h.html" title="thermodynamics.h" alt="" coords="254,372,384,397"/>
<area shape="rect" id="node21" href="evolver__ndf15_8h_source.html" title="evolver_ndf15.h" alt="" coords="526,445,642,471"/>
<area shape="rect" id="node23" href="evolver__rkck_8h_source.html" title="evolver_rkck.h" alt="" coords="436,372,543,397"/>
<area shape="rect" id="node7" href="background_8h.html" title="background.h" alt="" coords="244,445,346,471"/>
<area shape="rect" id="node8" href="common_8h.html" title="common.h" alt="" coords="396,592,479,617"/>
<area shape="rect" id="node16" href="quadrature_8h_source.html" title="quadrature.h" alt="" coords="22,519,119,544"/>
<area shape="rect" id="node18" href="arrays_8h_source.html" title="arrays.h" alt="" coords="260,519,330,544"/>
<area shape="rect" id="node19" href="dei__rkck_8h_source.html" title="dei_rkck.h" alt="" coords="447,519,529,544"/>
<area shape="rect" id="node20" href="parser_8h_source.html" title="parser.h" alt="" coords="353,519,423,544"/>
<area shape="rect" id="node14" href="svnversion_8h_source.html" title="svnversion.h" alt="" coords="576,665,672,691"/>
<area shape="rect" id="node22" href="sparse_8h_source.html" title="sparse.h" alt="" coords="604,519,676,544"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a226ea453047ad9f9b4baa8527f9fefd1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#a226ea453047ad9f9b4baa8527f9fefd1">transfer_functions_at_q</a> (struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *ptr, int index_md, int index_ic, int index_tt, int index_l, double q, double *transfer_function)</td></tr>
<tr class="separator:a226ea453047ad9f9b4baa8527f9fefd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ed9b28044b1e58d74494915b3ff5b10"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#a7ed9b28044b1e58d74494915b3ff5b10">transfer_init</a> (struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="background_8h.html#structbackground">background</a> *pba, struct <a class="el" href="thermodynamics_8h.html#structthermo">thermo</a> *pth, struct <a class="el" href="perturbations_8h.html#structperturbs">perturbs</a> *ppt, struct <a class="el" href="structnonlinear.html">nonlinear</a> *pnl, struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *ptr)</td></tr>
<tr class="separator:a7ed9b28044b1e58d74494915b3ff5b10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6debba506b0d424b93b56b8767656d07"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#a6debba506b0d424b93b56b8767656d07">transfer_free</a> (struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *ptr)</td></tr>
<tr class="separator:a6debba506b0d424b93b56b8767656d07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ae4f487bf63b45198fda351e2c87696"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#a4ae4f487bf63b45198fda351e2c87696">transfer_indices_of_transfers</a> (struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="perturbations_8h.html#structperturbs">perturbs</a> *ppt, struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *ptr, double q_period, double K, int sgnK)</td></tr>
<tr class="separator:a4ae4f487bf63b45198fda351e2c87696"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad59d5c2a8ace2403d8375883482bbad5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#ad59d5c2a8ace2403d8375883482bbad5">transfer_get_l_list</a> (struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="perturbations_8h.html#structperturbs">perturbs</a> *ppt, struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *ptr)</td></tr>
<tr class="separator:ad59d5c2a8ace2403d8375883482bbad5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d50cb722ee213f9c48a77df7ce85cd1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#a9d50cb722ee213f9c48a77df7ce85cd1">transfer_get_q_list</a> (struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="perturbations_8h.html#structperturbs">perturbs</a> *ppt, struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *ptr, double q_period, double K, int sgnK)</td></tr>
<tr class="separator:a9d50cb722ee213f9c48a77df7ce85cd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3f0d949e2ef800f718c11fdd5c1354e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#ac3f0d949e2ef800f718c11fdd5c1354e">transfer_get_k_list</a> (struct <a class="el" href="perturbations_8h.html#structperturbs">perturbs</a> *ppt, struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *ptr, double K)</td></tr>
<tr class="separator:ac3f0d949e2ef800f718c11fdd5c1354e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3e81b8369f6de9bc2dc7b8c02e10ceb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#ae3e81b8369f6de9bc2dc7b8c02e10ceb">transfer_get_source_correspondence</a> (struct <a class="el" href="perturbations_8h.html#structperturbs">perturbs</a> *ppt, struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *ptr, int **tp_of_tt)</td></tr>
<tr class="separator:ae3e81b8369f6de9bc2dc7b8c02e10ceb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c9363d6dd2b5845bc8d41d5c7611d7a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#a5c9363d6dd2b5845bc8d41d5c7611d7a">transfer_source_tau_size</a> (struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="background_8h.html#structbackground">background</a> *pba, struct <a class="el" href="perturbations_8h.html#structperturbs">perturbs</a> *ppt, struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *ptr, double tau_rec, double tau0, int index_md, int index_tt, int *tau_size)</td></tr>
<tr class="separator:a5c9363d6dd2b5845bc8d41d5c7611d7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0790ada9b74ac2325edc23a68eb1f72"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#aa0790ada9b74ac2325edc23a68eb1f72">transfer_compute_for_each_q</a> (struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="background_8h.html#structbackground">background</a> *pba, struct <a class="el" href="perturbations_8h.html#structperturbs">perturbs</a> *ppt, struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *ptr, int **tp_of_tt, int index_q, int tau_size_max, double tau_rec, double ***pert_sources, double ***pert_sources_spline, struct <a class="el" href="transfer_8h.html#structtransfer__workspace">transfer_workspace</a> *ptw)</td></tr>
<tr class="separator:aa0790ada9b74ac2325edc23a68eb1f72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad966994d25435082cd027960de7ab356"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#ad966994d25435082cd027960de7ab356">transfer_interpolate_sources</a> (struct <a class="el" href="perturbations_8h.html#structperturbs">perturbs</a> *ppt, struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *ptr, int index_q, int index_md, int index_ic, int index_type, double *pert_source, double *pert_source_spline, double *interpolated_sources)</td></tr>
<tr class="separator:ad966994d25435082cd027960de7ab356"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b622143337865b857779564eefb2a7b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#a9b622143337865b857779564eefb2a7b">transfer_sources</a> (struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="background_8h.html#structbackground">background</a> *pba, struct <a class="el" href="perturbations_8h.html#structperturbs">perturbs</a> *ppt, struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *ptr, double *interpolated_sources, double tau_rec, int index_q, int index_md, int index_tt, double *sources, double *tau0_minus_tau, double *w_trapz, int *tau_size_out)</td></tr>
<tr class="separator:a9b622143337865b857779564eefb2a7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87c33899832bba51d62fbeef87a25fe0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#a87c33899832bba51d62fbeef87a25fe0">transfer_selection_function</a> (struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="perturbations_8h.html#structperturbs">perturbs</a> *ppt, struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *ptr, int bin, double z, double *selection)</td></tr>
<tr class="separator:a87c33899832bba51d62fbeef87a25fe0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe1acfe299e7d241e2db5d089db70ca0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#afe1acfe299e7d241e2db5d089db70ca0">transfer_dNdz_analytic</a> (struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *ptr, double z, double *dNdz, double *dln_dNdz_dz)</td></tr>
<tr class="separator:afe1acfe299e7d241e2db5d089db70ca0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52265dbcef681f416e9a51d4477e268a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#a52265dbcef681f416e9a51d4477e268a">transfer_selection_sampling</a> (struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="background_8h.html#structbackground">background</a> *pba, struct <a class="el" href="perturbations_8h.html#structperturbs">perturbs</a> *ppt, struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *ptr, int bin, double *tau0_minus_tau, int tau_size)</td></tr>
<tr class="separator:a52265dbcef681f416e9a51d4477e268a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6776393e90246342ec38f567323cbe68"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#a6776393e90246342ec38f567323cbe68">transfer_lensing_sampling</a> (struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="background_8h.html#structbackground">background</a> *pba, struct <a class="el" href="perturbations_8h.html#structperturbs">perturbs</a> *ppt, struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *ptr, int bin, double tau0, double *tau0_minus_tau, int tau_size)</td></tr>
<tr class="separator:a6776393e90246342ec38f567323cbe68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94d64b8304fc2453d448c41716e8c89f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#a94d64b8304fc2453d448c41716e8c89f">transfer_source_resample</a> (struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="background_8h.html#structbackground">background</a> *pba, struct <a class="el" href="perturbations_8h.html#structperturbs">perturbs</a> *ppt, struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *ptr, int bin, double *tau0_minus_tau, int tau_size, int index_md, double tau0, double *interpolated_sources, double *sources)</td></tr>
<tr class="separator:a94d64b8304fc2453d448c41716e8c89f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cc20b516c44760847dd4455633be1b9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#a2cc20b516c44760847dd4455633be1b9">transfer_selection_times</a> (struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="background_8h.html#structbackground">background</a> *pba, struct <a class="el" href="perturbations_8h.html#structperturbs">perturbs</a> *ppt, struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *ptr, int bin, double *tau_min, double *tau_mean, double *tau_max)</td></tr>
<tr class="separator:a2cc20b516c44760847dd4455633be1b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55cd5cd7416ec0013204f839da1326ef"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#a55cd5cd7416ec0013204f839da1326ef">transfer_selection_compute</a> (struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="background_8h.html#structbackground">background</a> *pba, struct <a class="el" href="perturbations_8h.html#structperturbs">perturbs</a> *ppt, struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *ptr, double *selection, double *tau0_minus_tau, double *w_trapz, int tau_size, double *pvecback, double tau0, int bin)</td></tr>
<tr class="separator:a55cd5cd7416ec0013204f839da1326ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fcf8cc8e561263cdc2d3d39cebd9a5d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#a0fcf8cc8e561263cdc2d3d39cebd9a5d">transfer_compute_for_each_l</a> (struct <a class="el" href="transfer_8h.html#structtransfer__workspace">transfer_workspace</a> *ptw, struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="perturbations_8h.html#structperturbs">perturbs</a> *ppt, struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *ptr, int index_q, int index_md, int index_ic, int index_tt, int index_l, double l, double q_max_bessel, <a class="el" href="transfer_8h.html#af3f4670b8918a9905edf8d0c2c5ce32b">radial_function_type</a> radial_type)</td></tr>
<tr class="separator:a0fcf8cc8e561263cdc2d3d39cebd9a5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0fb04f4bb7b95408de7adbe9e6da505"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#ad0fb04f4bb7b95408de7adbe9e6da505">transfer_integrate</a> (struct <a class="el" href="perturbations_8h.html#structperturbs">perturbs</a> *ppt, struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *ptr, struct <a class="el" href="transfer_8h.html#structtransfer__workspace">transfer_workspace</a> *ptw, int index_q, int index_md, int index_tt, double l, int index_l, double k, <a class="el" href="transfer_8h.html#af3f4670b8918a9905edf8d0c2c5ce32b">radial_function_type</a> radial_type, double *trsf)</td></tr>
<tr class="separator:ad0fb04f4bb7b95408de7adbe9e6da505"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe288a49a5044b79cef9ea63123fe56b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#abe288a49a5044b79cef9ea63123fe56b">transfer_limber</a> (struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *ptr, struct <a class="el" href="transfer_8h.html#structtransfer__workspace">transfer_workspace</a> *ptw, int index_md, int index_q, double l, double q, <a class="el" href="transfer_8h.html#af3f4670b8918a9905edf8d0c2c5ce32b">radial_function_type</a> radial_type, double *trsf)</td></tr>
<tr class="separator:abe288a49a5044b79cef9ea63123fe56b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0b2d5188d0476ba4c1a6633c3278dfb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#ac0b2d5188d0476ba4c1a6633c3278dfb">transfer_limber_interpolate</a> (struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *ptr, double *tau0_minus_tau, double *sources, int tau_size, double tau0_minus_tau_limber, double *S)</td></tr>
<tr class="separator:ac0b2d5188d0476ba4c1a6633c3278dfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ab33e807dff2fdbd878908f18fbb0c2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#a6ab33e807dff2fdbd878908f18fbb0c2">transfer_limber2</a> (int tau_size, struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *ptr, int index_md, int index_k, double l, double k, double *tau0_minus_tau, double *sources, <a class="el" href="transfer_8h.html#af3f4670b8918a9905edf8d0c2c5ce32b">radial_function_type</a> radial_type, double *trsf)</td></tr>
<tr class="separator:a6ab33e807dff2fdbd878908f18fbb0c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Documented transfer module.</p>
<p>Julien Lesgourgues, 28.07.2013</p>
<p>This module has two purposes:</p>
<ul>
<li>at the beginning, to compute the transfer functions <img class="formulaInl" alt="$ \Delta_l^{X} (q) $" src="form_127.png"/>, and store them in tables used for interpolation in other modules.</li>
<li>at any time in the code, to evaluate the transfer functions (for a given mode, initial condition, type and multipole l) at any wavenumber q (by interpolating within the interpolation table).</li>
</ul>
<p>Hence the following functions can be called from other modules:</p>
<ol type="1">
<li><a class="el" href="transfer_8c.html#a7ed9b28044b1e58d74494915b3ff5b10">transfer_init()</a> at the beginning (but after <a class="el" href="perturbations_8c.html#a8c49cf2b10de95fbf09d8823bc37c512">perturb_init()</a> and bessel_init())</li>
<li><a class="el" href="transfer_8c.html#a226ea453047ad9f9b4baa8527f9fefd1">transfer_functions_at_q()</a> at any later time</li>
<li><a class="el" href="transfer_8c.html#a6debba506b0d424b93b56b8767656d07">transfer_free()</a> at the end, when no more calls to <a class="el" href="transfer_8c.html#a226ea453047ad9f9b4baa8527f9fefd1">transfer_functions_at_q()</a> are needed</li>
</ol>
<p>Note that in the standard implementation of CLASS, only the pre-computed values of the transfer functions are used, no interpolation is necessary; hence the routine <a class="el" href="transfer_8c.html#a226ea453047ad9f9b4baa8527f9fefd1">transfer_functions_at_q()</a> is actually never called. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a226ea453047ad9f9b4baa8527f9fefd1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a226ea453047ad9f9b4baa8527f9fefd1">&#9670;&nbsp;</a></span>transfer_functions_at_q()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_functions_at_q </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_md</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_ic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_tt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>transfer_function</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Transfer function <img class="formulaInl" alt="$ \Delta_l^{X} (q) $" src="form_127.png"/> at a given wavenumber q.</p>
<p>For a given mode (scalar, vector, tensor), initial condition, type (temperature, polarization, lensing, etc) and multipole, computes the transfer function for an arbitrary value of q by interpolating between pre-computed values of q. This function can be called from whatever module at whatever time, provided that <a class="el" href="transfer_8c.html#a7ed9b28044b1e58d74494915b3ff5b10">transfer_init()</a> has been called before, and <a class="el" href="transfer_8c.html#a6debba506b0d424b93b56b8767656d07">transfer_free()</a> has not been called yet.</p>
<p>Wavenumbers are called q in this module and k in the perturbation module. In flat universes k=q. In non-flat universes q and k differ through <img class="formulaInl" alt="$ q2 = k2 + K(1+m)$" src="form_290.png"/>, where m=0,1,2 for scalar, vector, tensor. q should be used throughout the transfer module, excepted when interpolating or manipulating the source functions S(k,tau) calculated in the perturbation module: for a given value of q, this should be done at the corresponding k(q).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ptr</td><td>Input: pointer to transfer structure </td></tr>
    <tr><td class="paramname">index_md</td><td>Input: index of requested mode </td></tr>
    <tr><td class="paramname">index_ic</td><td>Input: index of requested initial condition </td></tr>
    <tr><td class="paramname">index_tt</td><td>Input: index of requested type </td></tr>
    <tr><td class="paramname">index_l</td><td>Input: index of requested multipole </td></tr>
    <tr><td class="paramname">q</td><td>Input: any wavenumber </td></tr>
    <tr><td class="paramname">transfer_function</td><td>Output: transfer function </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<ul>
<li>interpolate in pre-computed table using array_interpolate_two() </li>
</ul>

</div>
</div>
<a id="a7ed9b28044b1e58d74494915b3ff5b10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ed9b28044b1e58d74494915b3ff5b10">&#9670;&nbsp;</a></span>transfer_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_init </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="background_8h.html#structbackground">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermo">thermo</a> *&#160;</td>
          <td class="paramname"><em>pth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="perturbations_8h.html#structperturbs">perturbs</a> *&#160;</td>
          <td class="paramname"><em>ppt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structnonlinear.html">nonlinear</a> *&#160;</td>
          <td class="paramname"><em>pnl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This routine initializes the transfers structure, (in particular, computes table of transfer functions <img class="formulaInl" alt="$ \Delta_l^{X} (q) $" src="form_127.png"/>)</p>
<p>Main steps:</p>
<ul>
<li>initialize all indices in the transfers structure and allocate all its arrays using <a class="el" href="transfer_8c.html#a4ae4f487bf63b45198fda351e2c87696">transfer_indices_of_transfers()</a>.</li>
<li>for each thread (in case of parallel run), initialize the fields of a memory zone called the <a class="el" href="transfer_8h.html#structtransfer__workspace">transfer_workspace</a> with transfer_workspace_init()</li>
<li>loop over q values. For each q, compute the Bessel functions if needed with transfer_update_HIS(), and defer the calculation of all transfer functions to <a class="el" href="transfer_8c.html#aa0790ada9b74ac2325edc23a68eb1f72">transfer_compute_for_each_q()</a></li>
<li>for each thread, free the the workspace with transfer_workspace_free()</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppr</td><td>Input: pointer to precision structure </td></tr>
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">pth</td><td>Input: pointer to thermodynamics structure </td></tr>
    <tr><td class="paramname">ppt</td><td>Input: pointer to perturbation structure </td></tr>
    <tr><td class="paramname">pnl</td><td>Input: pointer to nonlinear structure </td></tr>
    <tr><td class="paramname">ptr</td><td>Output: pointer to initialized transfers structure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<ul>
<li>define local variables</li>
<li>array with the correspondence between the index of sources in the perturbation module and in the transfer module, tp_of_tt[index_md][index_tt]</li>
<li>check whether any spectrum in harmonic space (i.e., any <img class="formulaInl" alt="$C_l$" src="form_4.png"/>'s) is actually requested</li>
<li>get number of modes (scalars, tensors...)</li>
<li>get conformal age / recombination time from background / thermodynamics structures (only place where these structures are used in this module)</li>
<li>correspondence between k and l depend on angular diameter distance, i.e. on curvature.</li>
<li>order of magnitude of the oscillation period of transfer functions</li>
<li>initialize all indices in the transfers structure and allocate all its arrays using <a class="el" href="transfer_8c.html#a4ae4f487bf63b45198fda351e2c87696">transfer_indices_of_transfers()</a></li>
<li>copy sources to a local array sources (in fact, only the pointers are copied, not the data), and eventually apply non-linear corrections to the sources</li>
<li>spline all the sources passed by the perturbation module with respect to k (in order to interpolate later at a given value of k)</li>
<li>allocate and fill array describing the correspondence between perturbation types and transfer types</li>
<li>evaluate maximum number of sampled times in the transfer sources: needs to be known here, in order to allocate a large enough workspace</li>
<li>compute flat spherical bessel functions</li>
<li>eventually read the selection and evolution functions</li>
<li>loop over all wavenumbers (parallelized).</li>
<li>finally, free arrays allocated outside parallel zone </li>
</ul>

</div>
</div>
<a id="a6debba506b0d424b93b56b8767656d07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6debba506b0d424b93b56b8767656d07">&#9670;&nbsp;</a></span>transfer_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *&#160;</td>
          <td class="paramname"><em>ptr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This routine frees all the memory space allocated by <a class="el" href="transfer_8c.html#a7ed9b28044b1e58d74494915b3ff5b10">transfer_init()</a>.</p>
<p>To be called at the end of each run, only when no further calls to transfer_functions_at_k() are needed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ptr</td><td>Input: pointer to transfers structure (which fields must be freed) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>

</div>
</div>
<a id="a4ae4f487bf63b45198fda351e2c87696"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ae4f487bf63b45198fda351e2c87696">&#9670;&nbsp;</a></span>transfer_indices_of_transfers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_indices_of_transfers </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="perturbations_8h.html#structperturbs">perturbs</a> *&#160;</td>
          <td class="paramname"><em>ppt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>q_period</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>K</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sgnK</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This routine defines all indices and allocates all tables in the transfers structure</p>
<p>Compute list of (k, l) values, allocate and fill corresponding arrays in the transfers structure. Allocate the array of transfer function tables.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppr</td><td>Input: pointer to precision structure </td></tr>
    <tr><td class="paramname">ppt</td><td>Input: pointer to perturbation structure </td></tr>
    <tr><td class="paramname">ptr</td><td>Input/Output: pointer to transfer structure </td></tr>
    <tr><td class="paramname">q_period</td><td>Input: order of magnitude of the oscillation period of transfer functions </td></tr>
    <tr><td class="paramname">K</td><td>Input: spatial curvature (in absolute value) </td></tr>
    <tr><td class="paramname">sgnK</td><td>Input: spatial curvature sign (open/closed/flat) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<ul>
<li>define local variables</li>
<li>define indices for transfer types</li>
<li>type indices common to scalars and tensors</li>
<li>type indices for scalars</li>
<li>type indices for vectors</li>
<li>type indices for tensors</li>
<li>allocate arrays of (k, l) values and transfer functions</li>
<li>get q values using <a class="el" href="transfer_8c.html#a9d50cb722ee213f9c48a77df7ce85cd1">transfer_get_q_list()</a></li>
<li>get k values using <a class="el" href="transfer_8c.html#ac3f0d949e2ef800f718c11fdd5c1354e">transfer_get_k_list()</a></li>
<li>get l values using <a class="el" href="transfer_8c.html#ad59d5c2a8ace2403d8375883482bbad5">transfer_get_l_list()</a></li>
<li>loop over modes (scalar, etc). For each mode:</li>
<li>allocate arrays of transfer functions, (ptr-&gt;transfer[index_md])[index_ic][index_tt][index_l][index_k] </li>
</ul>

</div>
</div>
<a id="ad59d5c2a8ace2403d8375883482bbad5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad59d5c2a8ace2403d8375883482bbad5">&#9670;&nbsp;</a></span>transfer_get_l_list()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_get_l_list </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="perturbations_8h.html#structperturbs">perturbs</a> *&#160;</td>
          <td class="paramname"><em>ppt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This routine defines the number and values of multipoles l for all modes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppr</td><td>Input: pointer to precision structure </td></tr>
    <tr><td class="paramname">ppt</td><td>Input: pointer to perturbation structure </td></tr>
    <tr><td class="paramname">ptr</td><td>Input/Output: pointer to transfers structure containing l's </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<ul>
<li>allocate and fill l array</li>
<li>start from l = 2 and increase with logarithmic step</li>
<li>when the logarithmic step becomes larger than some linear step, stick to this linear step till l_max</li>
<li>last value set to exactly l_max</li>
<li>so far we just counted the number of values. Now repeat the whole thing but fill array with values. </li>
</ul>

</div>
</div>
<a id="a9d50cb722ee213f9c48a77df7ce85cd1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d50cb722ee213f9c48a77df7ce85cd1">&#9670;&nbsp;</a></span>transfer_get_q_list()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_get_q_list </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="perturbations_8h.html#structperturbs">perturbs</a> *&#160;</td>
          <td class="paramname"><em>ppt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>q_period</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>K</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sgnK</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This routine defines the number and values of wavenumbers q for each mode (goes smoothly from logarithmic step for small q's to linear step for large q's).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppr</td><td>Input: pointer to precision structure </td></tr>
    <tr><td class="paramname">ppt</td><td>Input: pointer to perturbation structure </td></tr>
    <tr><td class="paramname">ptr</td><td>Input/Output: pointer to transfers structure containing q's </td></tr>
    <tr><td class="paramname">q_period</td><td>Input: order of magnitude of the oscillation period of transfer functions </td></tr>
    <tr><td class="paramname">K</td><td>Input: spatial curvature (in absolute value) </td></tr>
    <tr><td class="paramname">sgnK</td><td>Input: spatial curvature sign (open/closed/flat) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>

</div>
</div>
<a id="ac3f0d949e2ef800f718c11fdd5c1354e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3f0d949e2ef800f718c11fdd5c1354e">&#9670;&nbsp;</a></span>transfer_get_k_list()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_get_k_list </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="perturbations_8h.html#structperturbs">perturbs</a> *&#160;</td>
          <td class="paramname"><em>ppt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>K</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This routine infers from the q values a list of corresponding k values for each mode.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppt</td><td>Input: pointer to perturbation structure </td></tr>
    <tr><td class="paramname">ptr</td><td>Input/Output: pointer to transfers structure containing q's </td></tr>
    <tr><td class="paramname">K</td><td>Input: spatial curvature </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>

</div>
</div>
<a id="ae3e81b8369f6de9bc2dc7b8c02e10ceb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3e81b8369f6de9bc2dc7b8c02e10ceb">&#9670;&nbsp;</a></span>transfer_get_source_correspondence()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_get_source_correspondence </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="perturbations_8h.html#structperturbs">perturbs</a> *&#160;</td>
          <td class="paramname"><em>ppt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&#160;</td>
          <td class="paramname"><em>tp_of_tt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This routine defines the correspondence between the sources in the perturbation and transfer module.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppt</td><td>Input: pointer to perturbation structure </td></tr>
    <tr><td class="paramname">ptr</td><td>Input: pointer to transfers structure containing l's </td></tr>
    <tr><td class="paramname">tp_of_tt</td><td>Input/Output: array with the correspondence (allocated before, filled here) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<ul>
<li>running index on modes</li>
<li>running index on transfer types</li>
<li>which source are we considering? Define correspondence between transfer types and source types </li>
</ul>

</div>
</div>
<a id="a5c9363d6dd2b5845bc8d41d5c7611d7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c9363d6dd2b5845bc8d41d5c7611d7a">&#9670;&nbsp;</a></span>transfer_source_tau_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_source_tau_size </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="background_8h.html#structbackground">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="perturbations_8h.html#structperturbs">perturbs</a> *&#160;</td>
          <td class="paramname"><em>ppt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tau_rec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tau0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_md</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_tt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>tau_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>the code makes a distinction between "perturbation sources" (e.g. gravitational potential) and "transfer sources" (e.g. total density fluctuations, obtained through the Poisson equation, and observed with a given selection function).</p>
<p>This routine computes the number of sampled time values for each type of transfer sources.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppr</td><td>Input: pointer to precision structure </td></tr>
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">ppt</td><td>Input: pointer to perturbation structure </td></tr>
    <tr><td class="paramname">ptr</td><td>Input: pointer to transfers structure </td></tr>
    <tr><td class="paramname">tau_rec</td><td>Input: recombination time </td></tr>
    <tr><td class="paramname">tau0</td><td>Input: time today </td></tr>
    <tr><td class="paramname">index_md</td><td>Input: index of the mode (scalar, tensor) </td></tr>
    <tr><td class="paramname">index_tt</td><td>Input: index of transfer type </td></tr>
    <tr><td class="paramname">tau_size</td><td>Output: pointer to number of sampled times </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>

</div>
</div>
<a id="aa0790ada9b74ac2325edc23a68eb1f72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0790ada9b74ac2325edc23a68eb1f72">&#9670;&nbsp;</a></span>transfer_compute_for_each_q()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_compute_for_each_q </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="background_8h.html#structbackground">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="perturbations_8h.html#structperturbs">perturbs</a> *&#160;</td>
          <td class="paramname"><em>ppt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&#160;</td>
          <td class="paramname"><em>tp_of_tt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tau_size_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tau_rec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double ***&#160;</td>
          <td class="paramname"><em>pert_sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double ***&#160;</td>
          <td class="paramname"><em>pert_sources_spline</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfer__workspace">transfer_workspace</a> *&#160;</td>
          <td class="paramname"><em>ptw</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Summary:</p>
<ul>
<li>define local variables<ul>
<li>we deal with workspaces, i.e. with contiguous memory zones (one per thread) containing various fields used by the integration routine</li>
</ul>
</li>
<li>for a given l, maximum value of k such that we can convolve the source with Bessel functions j_l(x) without reaching x_max</li>
<li>store the sources in the workspace and define all fields in this workspace</li>
<li>loop over all modes. For each mode</li>
<li>loop over initial conditions.</li>
<li>check if we must now deal with a new source with a new index ppt-&gt;index_type. If yes, interpolate it at the right values of k.</li>
<li>Select radial function type </li>
</ul>

</div>
</div>
<a id="ad966994d25435082cd027960de7ab356"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad966994d25435082cd027960de7ab356">&#9670;&nbsp;</a></span>transfer_interpolate_sources()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_interpolate_sources </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="perturbations_8h.html#structperturbs">perturbs</a> *&#160;</td>
          <td class="paramname"><em>ppt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_md</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_ic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>pert_source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>pert_source_spline</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>interpolated_sources</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This routine interpolates sources <img class="formulaInl" alt="$ S(k, \tau) $" src="form_87.png"/> for each mode, initial condition and type (of perturbation module), to get them at the right values of k, using the spline interpolation method.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppt</td><td>Input: pointer to perturbation structure </td></tr>
    <tr><td class="paramname">ptr</td><td>Input: pointer to transfers structure </td></tr>
    <tr><td class="paramname">index_q</td><td>Input: index of wavenumber </td></tr>
    <tr><td class="paramname">index_md</td><td>Input: index of mode </td></tr>
    <tr><td class="paramname">index_ic</td><td>Input: index of initial condition </td></tr>
    <tr><td class="paramname">index_type</td><td>Input: index of type of source (in perturbation module) </td></tr>
    <tr><td class="paramname">pert_source</td><td>Input: array of sources </td></tr>
    <tr><td class="paramname">pert_source_spline</td><td>Input: array of second derivative of sources </td></tr>
    <tr><td class="paramname">interpolated_sources</td><td>Output: array of interpolated sources (filled here but allocated in <a class="el" href="transfer_8c.html#a7ed9b28044b1e58d74494915b3ff5b10">transfer_init()</a> to avoid numerous reallocation) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<ul>
<li>define local variables</li>
<li>interpolate at each k value using the usual spline interpolation algorithm. </li>
</ul>

</div>
</div>
<a id="a9b622143337865b857779564eefb2a7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b622143337865b857779564eefb2a7b">&#9670;&nbsp;</a></span>transfer_sources()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_sources </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="background_8h.html#structbackground">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="perturbations_8h.html#structperturbs">perturbs</a> *&#160;</td>
          <td class="paramname"><em>ppt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>interpolated_sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tau_rec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_md</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_tt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>tau0_minus_tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>w_trapz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>tau_size_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The code makes a distinction between "perturbation sources" (e.g. gravitational potential) and "transfer sources" (e.g. total density fluctuations, obtained through the Poisson equation, and observed with a given selection function).</p>
<p>This routine computes the transfer source given the interpolated perturbation source, and copies it in the workspace.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppr</td><td>Input: pointer to precision structure </td></tr>
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">ppt</td><td>Input: pointer to perturbation structure </td></tr>
    <tr><td class="paramname">ptr</td><td>Input: pointer to transfers structure </td></tr>
    <tr><td class="paramname">interpolated_sources</td><td>Input: interpolated perturbation source </td></tr>
    <tr><td class="paramname">tau_rec</td><td>Input: recombination time </td></tr>
    <tr><td class="paramname">index_q</td><td>Input: index of wavenumber </td></tr>
    <tr><td class="paramname">index_md</td><td>Input: index of mode </td></tr>
    <tr><td class="paramname">index_tt</td><td>Input: index of type of (transfer) source </td></tr>
    <tr><td class="paramname">sources</td><td>Output: transfer source </td></tr>
    <tr><td class="paramname">tau0_minus_tau</td><td>Output: values of (tau0-tau) at which source are sample </td></tr>
    <tr><td class="paramname">w_trapz</td><td>Output: trapezoidal weights for integration over tau </td></tr>
    <tr><td class="paramname">tau_size_out</td><td>Output: pointer to size of previous two arrays, converted to double </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<ul>
<li>define local variables<ul>
<li>in which cases are perturbation and transfer sources are different? I.e., in which case do we need to multiply the sources by some background and/or window function, and eventually to resample it, or redefine its time limits?</li>
<li>case where we need to redefine by a window function (or any function of the background and of k)</li>
</ul>
</li>
<li>case where we do not need to redefine<ul>
<li>return tau_size value that will be stored in the workspace (the workspace wants a double) </li>
</ul>
</li>
</ul>

</div>
</div>
<a id="a87c33899832bba51d62fbeef87a25fe0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87c33899832bba51d62fbeef87a25fe0">&#9670;&nbsp;</a></span>transfer_selection_function()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_selection_function </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="perturbations_8h.html#structperturbs">perturbs</a> *&#160;</td>
          <td class="paramname"><em>ppt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>selection</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Arbitrarily normalized selection function dN/dz(z,bin)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppr</td><td>Input: pointer to precision structure </td></tr>
    <tr><td class="paramname">ppt</td><td>Input: pointer to perturbation structure </td></tr>
    <tr><td class="paramname">ptr</td><td>Input: pointer to transfers structure </td></tr>
    <tr><td class="paramname">bin</td><td>Input: redshift bin number </td></tr>
    <tr><td class="paramname">z</td><td>Input: one value of redshift </td></tr>
    <tr><td class="paramname">selection</td><td>Output: pointer to selection function </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>

</div>
</div>
<a id="afe1acfe299e7d241e2db5d089db70ca0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe1acfe299e7d241e2db5d089db70ca0">&#9670;&nbsp;</a></span>transfer_dNdz_analytic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_dNdz_analytic </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>dNdz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>dln_dNdz_dz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Analytic form for dNdz distribution, from arXiv:1004.4640</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ptr</td><td>Input: pointer to transfer structure </td></tr>
    <tr><td class="paramname">z</td><td>Input: redshift </td></tr>
    <tr><td class="paramname">dNdz</td><td>Output: density per redshift, dN/dZ </td></tr>
    <tr><td class="paramname">dln_dNdz_dz</td><td>Output: dln(dN/dz)/dz, used optionally for the source evolution </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>

</div>
</div>
<a id="a52265dbcef681f416e9a51d4477e268a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52265dbcef681f416e9a51d4477e268a">&#9670;&nbsp;</a></span>transfer_selection_sampling()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_selection_sampling </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="background_8h.html#structbackground">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="perturbations_8h.html#structperturbs">perturbs</a> *&#160;</td>
          <td class="paramname"><em>ppt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>tau0_minus_tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tau_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>For sources that need to be multiplied by a selection function, redefine a finer time sampling in a small range</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppr</td><td>Input: pointer to precision structure </td></tr>
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">ppt</td><td>Input: pointer to perturbation structure </td></tr>
    <tr><td class="paramname">ptr</td><td>Input: pointer to transfers structure </td></tr>
    <tr><td class="paramname">bin</td><td>Input: redshift bin number </td></tr>
    <tr><td class="paramname">tau0_minus_tau</td><td>Output: values of (tau0-tau) at which source are sample </td></tr>
    <tr><td class="paramname">tau_size</td><td>Output: pointer to size of previous array </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>

</div>
</div>
<a id="a6776393e90246342ec38f567323cbe68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6776393e90246342ec38f567323cbe68">&#9670;&nbsp;</a></span>transfer_lensing_sampling()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_lensing_sampling </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="background_8h.html#structbackground">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="perturbations_8h.html#structperturbs">perturbs</a> *&#160;</td>
          <td class="paramname"><em>ppt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tau0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>tau0_minus_tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tau_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>For lensing sources that need to be convolved with a selection function, redefine the sampling within the range extending from the tau_min of the selection function up to tau0</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppr</td><td>Input: pointer to precision structure </td></tr>
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">ppt</td><td>Input: pointer to perturbation structure </td></tr>
    <tr><td class="paramname">ptr</td><td>Input: pointer to transfers structure </td></tr>
    <tr><td class="paramname">bin</td><td>Input: redshift bin number </td></tr>
    <tr><td class="paramname">tau0</td><td>Input: time today </td></tr>
    <tr><td class="paramname">tau0_minus_tau</td><td>Output: values of (tau0-tau) at which source are sample </td></tr>
    <tr><td class="paramname">tau_size</td><td>Output: pointer to size of previous array </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>

</div>
</div>
<a id="a94d64b8304fc2453d448c41716e8c89f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94d64b8304fc2453d448c41716e8c89f">&#9670;&nbsp;</a></span>transfer_source_resample()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_source_resample </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="background_8h.html#structbackground">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="perturbations_8h.html#structperturbs">perturbs</a> *&#160;</td>
          <td class="paramname"><em>ppt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>tau0_minus_tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tau_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_md</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tau0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>interpolated_sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>sources</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>For sources that need to be multiplied by a selection function, redefine a finer time sampling in a small range, and resample the perturbation sources at the new value by linear interpolation</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppr</td><td>Input: pointer to precision structure </td></tr>
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">ppt</td><td>Input: pointer to perturbation structure </td></tr>
    <tr><td class="paramname">ptr</td><td>Input: pointer to transfers structure </td></tr>
    <tr><td class="paramname">bin</td><td>Input: redshift bin number </td></tr>
    <tr><td class="paramname">tau0_minus_tau</td><td>Output: values of (tau0-tau) at which source are sample </td></tr>
    <tr><td class="paramname">tau_size</td><td>Output: pointer to size of previous array </td></tr>
    <tr><td class="paramname">index_md</td><td>Input: index of mode </td></tr>
    <tr><td class="paramname">tau0</td><td>Input: time today </td></tr>
    <tr><td class="paramname">interpolated_sources</td><td>Input: interpolated perturbation source </td></tr>
    <tr><td class="paramname">sources</td><td>Output: resampled transfer source </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>

</div>
</div>
<a id="a2cc20b516c44760847dd4455633be1b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2cc20b516c44760847dd4455633be1b9">&#9670;&nbsp;</a></span>transfer_selection_times()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_selection_times </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="background_8h.html#structbackground">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="perturbations_8h.html#structperturbs">perturbs</a> *&#160;</td>
          <td class="paramname"><em>ppt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>tau_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>tau_mean</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>tau_max</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>For each selection function, compute the min, mean and max values of conformal time (associated to the min, mean and max values of redshift specified by the user)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppr</td><td>Input: pointer to precision structure </td></tr>
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">ppt</td><td>Input: pointer to perturbation structure </td></tr>
    <tr><td class="paramname">ptr</td><td>Input: pointer to transfers structure </td></tr>
    <tr><td class="paramname">bin</td><td>Input: redshift bin number </td></tr>
    <tr><td class="paramname">tau_min</td><td>Output: smallest time in the selection interval </td></tr>
    <tr><td class="paramname">tau_mean</td><td>Output: time corresponding to z_mean </td></tr>
    <tr><td class="paramname">tau_max</td><td>Output: largest time in the selection interval </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>

</div>
</div>
<a id="a55cd5cd7416ec0013204f839da1326ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55cd5cd7416ec0013204f839da1326ef">&#9670;&nbsp;</a></span>transfer_selection_compute()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_selection_compute </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="background_8h.html#structbackground">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="perturbations_8h.html#structperturbs">perturbs</a> *&#160;</td>
          <td class="paramname"><em>ppt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>selection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>tau0_minus_tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>w_trapz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tau_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>pvecback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tau0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute and normalize selection function for a set of time values</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppr</td><td>Input: pointer to precision structure </td></tr>
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">ppt</td><td>Input: pointer to perturbation structure </td></tr>
    <tr><td class="paramname">ptr</td><td>Input: pointer to transfers structure </td></tr>
    <tr><td class="paramname">selection</td><td>Output: normalized selection function </td></tr>
    <tr><td class="paramname">tau0_minus_tau</td><td>Input: values of (tau0-tau) at which source are sample </td></tr>
    <tr><td class="paramname">w_trapz</td><td>Input: trapezoidal weights for integration over tau </td></tr>
    <tr><td class="paramname">tau_size</td><td>Input: size of previous two arrays </td></tr>
    <tr><td class="paramname">pvecback</td><td>Input: allocated array of background values </td></tr>
    <tr><td class="paramname">tau0</td><td>Input: time today </td></tr>
    <tr><td class="paramname">bin</td><td>Input: redshift bin number </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>

</div>
</div>
<a id="a0fcf8cc8e561263cdc2d3d39cebd9a5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0fcf8cc8e561263cdc2d3d39cebd9a5d">&#9670;&nbsp;</a></span>transfer_compute_for_each_l()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_compute_for_each_l </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfer__workspace">transfer_workspace</a> *&#160;</td>
          <td class="paramname"><em>ptw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="perturbations_8h.html#structperturbs">perturbs</a> *&#160;</td>
          <td class="paramname"><em>ppt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_md</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_ic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_tt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>q_max_bessel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="transfer_8h.html#af3f4670b8918a9905edf8d0c2c5ce32b">radial_function_type</a>&#160;</td>
          <td class="paramname"><em>radial_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This routine computes the transfer functions <img class="formulaInl" alt="$ \Delta_l^{X} (k) $" src="form_291.png"/>) as a function of wavenumber k for a given mode, initial condition, type and multipole l passed in input.</p>
<p>For a given value of k, the transfer function is inferred from the source function (passed in input in the array interpolated_sources) and from Bessel functions (passed in input in the bessels structure), either by convolving them along tau, or by a Limber approximation. This elementary task is distributed either to <a class="el" href="transfer_8c.html#ad0fb04f4bb7b95408de7adbe9e6da505">transfer_integrate()</a> or to <a class="el" href="transfer_8c.html#abe288a49a5044b79cef9ea63123fe56b">transfer_limber()</a>. The task of this routine is mainly to loop over k values, and to decide at which k_max the calculation can be stopped, according to some approximation scheme designed to find a compromise between execution time and precision. The approximation scheme is defined by parameters in the precision structure.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ptw</td><td>Input: pointer to <a class="el" href="transfer_8h.html#structtransfer__workspace">transfer_workspace</a> structure (allocated in <a class="el" href="transfer_8c.html#a7ed9b28044b1e58d74494915b3ff5b10">transfer_init()</a> to avoid numerous reallocation) </td></tr>
    <tr><td class="paramname">ppr</td><td>Input: pointer to precision structure </td></tr>
    <tr><td class="paramname">ppt</td><td>Input: pointer to perturbation structure </td></tr>
    <tr><td class="paramname">ptr</td><td>Input/output: pointer to transfers structure (result stored there) </td></tr>
    <tr><td class="paramname">index_q</td><td>Input: index of wavenumber </td></tr>
    <tr><td class="paramname">index_md</td><td>Input: index of mode </td></tr>
    <tr><td class="paramname">index_ic</td><td>Input: index of initial condition </td></tr>
    <tr><td class="paramname">index_tt</td><td>Input: index of type of transfer </td></tr>
    <tr><td class="paramname">index_l</td><td>Input: index of multipole </td></tr>
    <tr><td class="paramname">l</td><td>Input: multipole </td></tr>
    <tr><td class="paramname">q_max_bessel</td><td>Input: maximum value of argument q at which Bessel functions are computed </td></tr>
    <tr><td class="paramname">radial_type</td><td>Input: type of radial (Bessel) functions to convolve with </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<ul>
<li>define local variables</li>
<li>return zero transfer function if l is above l_max</li>
<li>store transfer function in transfer structure </li>
</ul>

</div>
</div>
<a id="ad0fb04f4bb7b95408de7adbe9e6da505"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0fb04f4bb7b95408de7adbe9e6da505">&#9670;&nbsp;</a></span>transfer_integrate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_integrate </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="perturbations_8h.html#structperturbs">perturbs</a> *&#160;</td>
          <td class="paramname"><em>ppt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfer__workspace">transfer_workspace</a> *&#160;</td>
          <td class="paramname"><em>ptw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_md</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_tt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="transfer_8h.html#af3f4670b8918a9905edf8d0c2c5ce32b">radial_function_type</a>&#160;</td>
          <td class="paramname"><em>radial_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>trsf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This routine computes the transfer functions <img class="formulaInl" alt="$ \Delta_l^{X} (k) $" src="form_291.png"/>) for each mode, initial condition, type, multipole l and wavenumber k, by convolving the source function (passed in input in the array interpolated_sources) with Bessel functions (passed in input in the bessels structure).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppt</td><td>Input: pointer to perturbation structure </td></tr>
    <tr><td class="paramname">ptr</td><td>Input: pointer to transfers structure </td></tr>
    <tr><td class="paramname">ptw</td><td>Input: pointer to <a class="el" href="transfer_8h.html#structtransfer__workspace">transfer_workspace</a> structure (allocated in <a class="el" href="transfer_8c.html#a7ed9b28044b1e58d74494915b3ff5b10">transfer_init()</a> to avoid numerous reallocation) </td></tr>
    <tr><td class="paramname">index_q</td><td>Input: index of wavenumber </td></tr>
    <tr><td class="paramname">index_md</td><td>Input: index of mode </td></tr>
    <tr><td class="paramname">index_tt</td><td>Input: index of type </td></tr>
    <tr><td class="paramname">l</td><td>Input: multipole </td></tr>
    <tr><td class="paramname">index_l</td><td>Input: index of multipole </td></tr>
    <tr><td class="paramname">k</td><td>Input: wavenumber </td></tr>
    <tr><td class="paramname">radial_type</td><td>Input: type of radial (Bessel) functions to convolve with </td></tr>
    <tr><td class="paramname">trsf</td><td>Output: transfer function <img class="formulaInl" alt="$ \Delta_l(k) $" src="form_292.png"/> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<ul>
<li>define local variables</li>
<li>find minimum value of (tau0-tau) at which <img class="formulaInl" alt="$ j_l(k[\tau_0-\tau]) $" src="form_293.png"/> is known, given that <img class="formulaInl" alt="$ j_l(x) $" src="form_294.png"/> is sampled above some finite value <img class="formulaInl" alt="$ x_{\min} $" src="form_295.png"/> (below which it can be approximated by zero)</li>
<li>if there is no overlap between the region in which bessels and sources are non-zero, return zero</li>
<li>if there is an overlap:</li>
<li>&ndash;&gt; trivial case: the source is a Dirac function and is sampled in only one point</li>
<li>&ndash;&gt; other cases</li>
<li>&mdash;&gt; (a) find index in the source's tau list corresponding to the last point in the overlapping region. After this step, index_tau_max can be as small as zero, but not negative.</li>
<li>&mdash;&gt; (b) the source function can vanish at large <img class="formulaInl" alt="$ \tau $" src="form_43.png"/>. Check if further points can be eliminated. After this step and if we did not return a null transfer function, index_tau_max can be as small as zero, but not negative.</li>
<li>Compute the radial function:</li>
<li>Now we do most of the convolution integral:</li>
<li>This integral is correct for the case where no truncation has occurred. If it has been truncated at some index_tau_max because f[index_tau_max+1]==0, it is still correct. The 'mistake' in using the wrong weight w_trapz[index_tau_max] is exactly compensated by the triangle we miss. However, for the Bessel cut off, we must subtract the wrong triangle and add the correct triangle. </li>
</ul>

</div>
</div>
<a id="abe288a49a5044b79cef9ea63123fe56b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe288a49a5044b79cef9ea63123fe56b">&#9670;&nbsp;</a></span>transfer_limber()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_limber </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfer__workspace">transfer_workspace</a> *&#160;</td>
          <td class="paramname"><em>ptw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_md</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="transfer_8h.html#af3f4670b8918a9905edf8d0c2c5ce32b">radial_function_type</a>&#160;</td>
          <td class="paramname"><em>radial_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>trsf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This routine computes the transfer functions <img class="formulaInl" alt="$ \Delta_l^{X} (k) $" src="form_291.png"/>) for each mode, initial condition, type, multipole l and wavenumber k, by using the Limber approximation, i.e by evaluating the source function (passed in input in the array interpolated_sources) at a single value of tau (the Bessel function being approximated as a Dirac distribution).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ptr</td><td>Input: pointer to transfers structure </td></tr>
    <tr><td class="paramname">ptw</td><td>Input: pointer to transfer workspace structure </td></tr>
    <tr><td class="paramname">index_md</td><td>Input: index of mode </td></tr>
    <tr><td class="paramname">index_q</td><td>Input: index of wavenumber </td></tr>
    <tr><td class="paramname">l</td><td>Input: multipole </td></tr>
    <tr><td class="paramname">q</td><td>Input: wavenumber </td></tr>
    <tr><td class="paramname">radial_type</td><td>Input: type of radial (Bessel) functions to convolve with </td></tr>
    <tr><td class="paramname">trsf</td><td>Output: transfer function <img class="formulaInl" alt="$ \Delta_l(k) $" src="form_292.png"/> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<ul>
<li>define local variables</li>
<li>get k, l and infer tau such that k(tau0-tau)=l+1/2; check that tau is in appropriate range</li>
<li>get transfer = source * <img class="formulaInl" alt="$ \sqrt{\pi/(2l+1)}/q $" src="form_296.png"/> = source*[tau0-tau] * <img class="formulaInl" alt="$ \sqrt{\pi/(2l+1)}/(l+1/2)$" src="form_297.png"/></li>
</ul>

</div>
</div>
<a id="ac0b2d5188d0476ba4c1a6633c3278dfb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0b2d5188d0476ba4c1a6633c3278dfb">&#9670;&nbsp;</a></span>transfer_limber_interpolate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_limber_interpolate </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>tau0_minus_tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tau_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tau0_minus_tau_limber</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>S</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<ul>
<li>find bracketing indices. index_tau must be at least 1 (so that index_tau-1 is at least 0) and at most tau_size-2 (so that index_tau+1 is at most tau_size-1).</li>
<li>interpolate by fitting a polynomial of order two; get source and its first two derivatives. Note that we are not interpolating S, but the product S*(tau0-tau). Indeed this product is regular in tau=tau0, while S alone diverges for lensing. </li>
</ul>

</div>
</div>
<a id="a6ab33e807dff2fdbd878908f18fbb0c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ab33e807dff2fdbd878908f18fbb0c2">&#9670;&nbsp;</a></span>transfer_limber2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_limber2 </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tau_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfers">transfers</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_md</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>tau0_minus_tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="transfer_8h.html#af3f4670b8918a9905edf8d0c2c5ce32b">radial_function_type</a>&#160;</td>
          <td class="paramname"><em>radial_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>trsf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This routine computes the transfer functions <img class="formulaInl" alt="$ \Delta_l^{X} (k) $" src="form_291.png"/>) for each mode, initial condition, type, multipole l and wavenumber k, by using the Limber approximation at order two, i.e as a function of the source function and its first two derivatives at a single value of tau</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tau_size</td><td>Input: size of conformal time array </td></tr>
    <tr><td class="paramname">ptr</td><td>Input: pointer to transfers structure </td></tr>
    <tr><td class="paramname">index_md</td><td>Input: index of mode </td></tr>
    <tr><td class="paramname">index_k</td><td>Input: index of wavenumber </td></tr>
    <tr><td class="paramname">l</td><td>Input: multipole </td></tr>
    <tr><td class="paramname">k</td><td>Input: wavenumber </td></tr>
    <tr><td class="paramname">tau0_minus_tau</td><td>Input: array of values of (tau_today - tau) </td></tr>
    <tr><td class="paramname">sources</td><td>Input: source functions </td></tr>
    <tr><td class="paramname">radial_type</td><td>Input: type of radial (Bessel) functions to convolve with </td></tr>
    <tr><td class="paramname">trsf</td><td>Output: transfer function <img class="formulaInl" alt="$ \Delta_l(k) $" src="form_292.png"/> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<ul>
<li>define local variables</li>
<li>get k, l and infer tau such that k(tau0-tau)=l+1/2; check that tau is in appropriate range</li>
<li>find bracketing indices</li>
<li>interpolate by fitting a polynomial of order two; get source and its first two derivatives</li>
<li>get transfer from 2nd order Limber approx (inferred from 0809.5112 [astro-ph]) </li>
</ul>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="transfer_8c.html">transfer.c</a></li>
    <li class="footer">Generated on Mon Oct 22 2018 16:09:37 for CLASS MANUAL by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>

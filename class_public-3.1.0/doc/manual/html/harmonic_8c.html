<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CLASS MANUAL: harmonic.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CLASS MANUAL
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('harmonic_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">harmonic.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="harmonic_8h_source.html">harmonic.h</a>&quot;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for harmonic.c:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="harmonic_8c__incl.png" border="0" usemap="#aharmonic_8c" alt=""/></div>
<map name="aharmonic_8c" id="aharmonic_8c">
<area shape="rect" title=" " alt="" coords="964,5,1051,32"/>
<area shape="rect" href="harmonic_8h.html" title=" " alt="" coords="964,80,1051,107"/>
<area shape="rect" href="transfer_8h.html" title=" " alt="" coords="969,155,1045,181"/>
<area shape="rect" href="fourier_8h.html" title=" " alt="" coords="811,229,879,256"/>
<area shape="rect" href="hyperspherical_8h_source.html" title=" " alt="" coords="894,379,1011,405"/>
<area shape="rect" title=" " alt="" coords="966,229,1049,256"/>
<area shape="rect" title=" " alt="" coords="1073,229,1153,256"/>
<area shape="rect" title=" " alt="" coords="1177,229,1240,256"/>
<area shape="rect" href="primordial_8h.html" title=" " alt="" coords="713,304,803,331"/>
<area shape="rect" href="trigonometric__integrals_8h_source.html" title=" " alt="" coords="763,453,927,480"/>
<area shape="rect" href="perturbations_8h.html" title=" " alt="" coords="617,379,725,405"/>
<area shape="rect" href="thermodynamics_8h.html" title=" " alt="" coords="524,453,653,480"/>
<area shape="rect" href="background_8h.html" title=" " alt="" coords="144,528,244,555"/>
<area shape="rect" href="evolver__ndf15_8h_source.html" title=" " alt="" coords="399,528,514,555"/>
<area shape="rect" href="evolver__rkck_8h_source.html" title=" " alt="" coords="269,528,375,555"/>
<area shape="rect" title=" " alt="" coords="539,528,639,555"/>
<area shape="rect" href="wrap__recfast_8h_source.html" title=" " alt="" coords="663,528,771,555"/>
<area shape="rect" href="injection_8h_source.html" title=" " alt="" coords="795,528,876,555"/>
<area shape="rect" href="common_8h.html" title=" " alt="" coords="529,677,611,704"/>
<area shape="rect" href="quadrature_8h_source.html" title=" " alt="" coords="28,603,123,629"/>
<area shape="rect" title=" " alt="" coords="147,603,239,629"/>
<area shape="rect" href="arrays_8h_source.html" title=" " alt="" coords="263,603,333,629"/>
<area shape="rect" href="dei__rkck_8h_source.html" title=" " alt="" coords="450,603,533,629"/>
<area shape="rect" href="parser_8h_source.html" title=" " alt="" coords="357,603,425,629"/>
<area shape="rect" title=" " alt="" coords="234,752,295,779"/>
<area shape="rect" title=" " alt="" coords="319,752,383,779"/>
<area shape="rect" title=" " alt="" coords="408,752,471,779"/>
<area shape="rect" title=" " alt="" coords="495,752,560,779"/>
<area shape="rect" title=" " alt="" coords="585,752,643,779"/>
<area shape="rect" href="svnversion_8h_source.html" title=" " alt="" coords="667,752,763,779"/>
<area shape="rect" title=" " alt="" coords="787,752,857,779"/>
<area shape="rect" href="precisions_8h_source.html" title=" " alt="" coords="881,752,973,779"/>
<area shape="rect" href="macros__precision_8h_source.html" title=" " alt="" coords="860,827,995,853"/>
<area shape="rect" href="sparse_8h_source.html" title=" " alt="" coords="607,603,679,629"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a04dc023d4ac3945d633cccfdcf6bf54a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="harmonic_8c.html#a04dc023d4ac3945d633cccfdcf6bf54a">harmonic_cl_at_l</a> (struct <a class="el" href="harmonic_8h.html#structharmonic">harmonic</a> *phr, double l, double *cl_tot, double **cl_md, double **cl_md_ic)</td></tr>
<tr class="separator:a04dc023d4ac3945d633cccfdcf6bf54a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a067c78b424fcde741b3c73658ccdc99e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="harmonic_8c.html#a067c78b424fcde741b3c73658ccdc99e">harmonic_init</a> (struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="background_8h.html#structbackground">background</a> *pba, struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *ppt, struct <a class="el" href="primordial_8h.html#structprimordial">primordial</a> *ppm, struct <a class="el" href="fourier_8h.html#structfourier">fourier</a> *pfo, struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *ptr, struct <a class="el" href="harmonic_8h.html#structharmonic">harmonic</a> *phr)</td></tr>
<tr class="separator:a067c78b424fcde741b3c73658ccdc99e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afdc8979327b76cf83ce4c4fb35ade32e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="harmonic_8c.html#afdc8979327b76cf83ce4c4fb35ade32e">harmonic_free</a> (struct <a class="el" href="harmonic_8h.html#structharmonic">harmonic</a> *phr)</td></tr>
<tr class="separator:afdc8979327b76cf83ce4c4fb35ade32e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad0d37aea47fab7fe3149c0a78e7a675"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="harmonic_8c.html#aad0d37aea47fab7fe3149c0a78e7a675">harmonic_indices</a> (struct <a class="el" href="background_8h.html#structbackground">background</a> *pba, struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *ppt, struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *ptr, struct <a class="el" href="primordial_8h.html#structprimordial">primordial</a> *ppm, struct <a class="el" href="harmonic_8h.html#structharmonic">harmonic</a> *phr)</td></tr>
<tr class="separator:aad0d37aea47fab7fe3149c0a78e7a675"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d1bdfd25afb6aa6c2ec4c71eb35849f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="harmonic_8c.html#a0d1bdfd25afb6aa6c2ec4c71eb35849f">harmonic_cls</a> (struct <a class="el" href="background_8h.html#structbackground">background</a> *pba, struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *ppt, struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *ptr, struct <a class="el" href="primordial_8h.html#structprimordial">primordial</a> *ppm, struct <a class="el" href="harmonic_8h.html#structharmonic">harmonic</a> *phr)</td></tr>
<tr class="separator:a0d1bdfd25afb6aa6c2ec4c71eb35849f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b511f641287b6959961b806dc048486"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="harmonic_8c.html#a3b511f641287b6959961b806dc048486">harmonic_compute_cl</a> (struct <a class="el" href="background_8h.html#structbackground">background</a> *pba, struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *ppt, struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *ptr, struct <a class="el" href="primordial_8h.html#structprimordial">primordial</a> *ppm, struct <a class="el" href="harmonic_8h.html#structharmonic">harmonic</a> *phr, int index_md, int index_ic1, int index_ic2, int index_l, int cl_integrand_num_columns, double *cl_integrand, double *primordial_pk, double *transfer_ic1, double *transfer_ic2)</td></tr>
<tr class="separator:a3b511f641287b6959961b806dc048486"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa401dd2909f2d4d7be55bf64ae665545"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="harmonic_8c.html#aa401dd2909f2d4d7be55bf64ae665545">harmonic_pk_at_z</a> (struct <a class="el" href="background_8h.html#structbackground">background</a> *pba, struct <a class="el" href="harmonic_8h.html#structharmonic">harmonic</a> *phr, enum <a class="el" href="primordial_8h.html#af97c57fb2cbf4f53e76a1c0ddfb04322">linear_or_logarithmic</a> mode, double z, double *output_tot, double *output_ic, double *output_cb_tot, double *output_cb_ic)</td></tr>
<tr class="separator:aa401dd2909f2d4d7be55bf64ae665545"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a263f7c692bac02179a9be3aa3a47109e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="harmonic_8c.html#a263f7c692bac02179a9be3aa3a47109e">harmonic_pk_at_k_and_z</a> (struct <a class="el" href="background_8h.html#structbackground">background</a> *pba, struct <a class="el" href="primordial_8h.html#structprimordial">primordial</a> *ppm, struct <a class="el" href="harmonic_8h.html#structharmonic">harmonic</a> *phr, double k, double z, double *pk_tot, double *pk_ic, double *pk_cb_tot, double *pk_cb_ic)</td></tr>
<tr class="separator:a263f7c692bac02179a9be3aa3a47109e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e15977952a0ae55ec39a19da2d148c4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="harmonic_8c.html#a2e15977952a0ae55ec39a19da2d148c4">harmonic_pk_nl_at_z</a> (struct <a class="el" href="background_8h.html#structbackground">background</a> *pba, struct <a class="el" href="harmonic_8h.html#structharmonic">harmonic</a> *phr, enum <a class="el" href="primordial_8h.html#af97c57fb2cbf4f53e76a1c0ddfb04322">linear_or_logarithmic</a> mode, double z, double *output_tot, double *output_cb_tot)</td></tr>
<tr class="separator:a2e15977952a0ae55ec39a19da2d148c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82e695a8ed2b6cbbddda56875ed38d55"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="harmonic_8c.html#a82e695a8ed2b6cbbddda56875ed38d55">harmonic_pk_nl_at_k_and_z</a> (struct <a class="el" href="background_8h.html#structbackground">background</a> *pba, struct <a class="el" href="primordial_8h.html#structprimordial">primordial</a> *ppm, struct <a class="el" href="harmonic_8h.html#structharmonic">harmonic</a> *phr, double k, double z, double *pk_tot, double *pk_cb_tot)</td></tr>
<tr class="separator:a82e695a8ed2b6cbbddda56875ed38d55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b1b28df71e0f0bb4757898997cb3918"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="harmonic_8c.html#a3b1b28df71e0f0bb4757898997cb3918">harmonic_fast_pk_at_kvec_and_zvec</a> (struct <a class="el" href="background_8h.html#structbackground">background</a> *pba, struct <a class="el" href="harmonic_8h.html#structharmonic">harmonic</a> *phr, double *kvec, int kvec_size, double *zvec, int zvec_size, double *pk_tot_out, double *pk_cb_tot_out, int nonlinear)</td></tr>
<tr class="separator:a3b1b28df71e0f0bb4757898997cb3918"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e5acde2947e419e828417896cd786c7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="harmonic_8c.html#a3e5acde2947e419e828417896cd786c7">harmonic_sigma</a> (struct <a class="el" href="background_8h.html#structbackground">background</a> *pba, struct <a class="el" href="primordial_8h.html#structprimordial">primordial</a> *ppm, struct <a class="el" href="harmonic_8h.html#structharmonic">harmonic</a> *phr, double R, double z, double *sigma)</td></tr>
<tr class="separator:a3e5acde2947e419e828417896cd786c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fde5b2875b452a59a94f8a291e91c29"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="harmonic_8c.html#a9fde5b2875b452a59a94f8a291e91c29">harmonic_sigma_cb</a> (struct <a class="el" href="background_8h.html#structbackground">background</a> *pba, struct <a class="el" href="primordial_8h.html#structprimordial">primordial</a> *ppm, struct <a class="el" href="harmonic_8h.html#structharmonic">harmonic</a> *phr, double R, double z, double *sigma_cb)</td></tr>
<tr class="separator:a9fde5b2875b452a59a94f8a291e91c29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b2ed426d396fb5900fcea5acbf103ee"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="harmonic_8c.html#a9b2ed426d396fb5900fcea5acbf103ee">harmonic_tk_at_z</a> (struct <a class="el" href="background_8h.html#structbackground">background</a> *pba, struct <a class="el" href="harmonic_8h.html#structharmonic">harmonic</a> *phr, double z, double *<a class="el" href="output_8h.html#structoutput">output</a>)</td></tr>
<tr class="separator:a9b2ed426d396fb5900fcea5acbf103ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43180bf64486df5b523fb90a6e3a36b8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="harmonic_8c.html#a43180bf64486df5b523fb90a6e3a36b8">harmonic_tk_at_k_and_z</a> (struct <a class="el" href="background_8h.html#structbackground">background</a> *pba, struct <a class="el" href="harmonic_8h.html#structharmonic">harmonic</a> *phr, double k, double z, double *<a class="el" href="output_8h.html#structoutput">output</a>)</td></tr>
<tr class="separator:a43180bf64486df5b523fb90a6e3a36b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Documented harmonic module</p>
<p>Julien Lesgourgues, 1.11.2019</p>
<p>This module computes the harmonic power spectra <img class="formulaInl" alt="$ C_l^{X} $" src="form_177.png" width="18" height="15"/>'s given the transfer functions and the primordial spectra.</p>
<p>The following functions can be called from other modules:</p>
<ol type="1">
<li><a class="el" href="harmonic_8c.html#a067c78b424fcde741b3c73658ccdc99e">harmonic_init()</a> at the beginning (but after <a class="el" href="transfer_8c.html#a96f1a37539a8a452fa71ef3971909bb2">transfer_init()</a>)</li>
<li><a class="el" href="harmonic_8c.html#a04dc023d4ac3945d633cccfdcf6bf54a">harmonic_cl_at_l()</a> at any time for computing individual <img class="formulaInl" alt="$ C_l $" src="form_70.png" width="11" height="13"/>'s at any l</li>
<li><a class="el" href="harmonic_8c.html#afdc8979327b76cf83ce4c4fb35ade32e">harmonic_free()</a> at the end </li>
</ol>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a04dc023d4ac3945d633cccfdcf6bf54a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04dc023d4ac3945d633cccfdcf6bf54a">&#9670;&nbsp;</a></span>harmonic_cl_at_l()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int harmonic_cl_at_l </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="harmonic_8h.html#structharmonic">harmonic</a> *&#160;</td>
          <td class="paramname"><em>phr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>cl_tot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>cl_md</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>cl_md_ic</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Anisotropy power spectra <img class="formulaInl" alt="$ C_l$" src="form_50.png" width="11" height="13"/>'s for all types, modes and initial conditions.</p>
<p>This routine evaluates all the <img class="formulaInl" alt="$C_l$" src="form_4.png" width="11" height="13"/>'s at a given value of l by interpolating in the pre-computed table. When relevant, it also sums over all initial conditions for each mode, and over all modes.</p>
<p>This function can be called from whatever module at whatever time, provided that <a class="el" href="harmonic_8c.html#a067c78b424fcde741b3c73658ccdc99e">harmonic_init()</a> has been called before, and <a class="el" href="harmonic_8c.html#afdc8979327b76cf83ce4c4fb35ade32e">harmonic_free()</a> has not been called yet.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">phr</td><td>Input: pointer to harmonic structure (containing pre-computed table) </td></tr>
    <tr><td class="paramname">l</td><td>Input: multipole number </td></tr>
    <tr><td class="paramname">cl_tot</td><td>Output: total <img class="formulaInl" alt="$C_l$" src="form_4.png" width="11" height="13"/>'s for all types (TT, TE, EE, etc..) </td></tr>
    <tr><td class="paramname">cl_md</td><td>Output: <img class="formulaInl" alt="$C_l$" src="form_4.png" width="11" height="13"/>'s for all types (TT, TE, EE, etc..) decomposed mode by mode (scalar, tensor, ...) when relevant </td></tr>
    <tr><td class="paramname">cl_md_ic</td><td>Output: <img class="formulaInl" alt="$C_l$" src="form_4.png" width="11" height="13"/>'s for all types (TT, TE, EE, etc..) decomposed by pairs of initial conditions (adiabatic, isocurvatures) for each mode (usually, only for the scalar mode) when relevant </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<ul>
<li>define local variables</li>
<li>(a) treat case in which there is only one mode and one initial condition. Then, only cl_tot needs to be filled.</li>
<li>(b) treat case in which there is only one mode with several initial condition. Fill cl_md_ic[index_md=0] and sum it to get cl_tot.</li>
<li>(c) loop over modes</li>
<li>--&gt; (c.1.) treat case in which the mode under consideration has only one initial condition. Fill cl_md[index_md].</li>
<li>--&gt; (c.2.) treat case in which the mode under consideration has several initial conditions. Fill cl_md_ic[index_md] and sum it to get cl_md[index_md]</li>
<li>--&gt; (c.3.) add contribution of cl_md[index_md] to cl_tot</li>
</ul>

</div>
</div>
<a id="a067c78b424fcde741b3c73658ccdc99e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a067c78b424fcde741b3c73658ccdc99e">&#9670;&nbsp;</a></span>harmonic_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int harmonic_init </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="background_8h.html#structbackground">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *&#160;</td>
          <td class="paramname"><em>ppt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="primordial_8h.html#structprimordial">primordial</a> *&#160;</td>
          <td class="paramname"><em>ppm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="fourier_8h.html#structfourier">fourier</a> *&#160;</td>
          <td class="paramname"><em>pfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="harmonic_8h.html#structharmonic">harmonic</a> *&#160;</td>
          <td class="paramname"><em>phr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This routine initializes the harmonic structure (in particular, computes table of anisotropy and Fourier spectra <img class="formulaInl" alt="$ C_l^{X}, P(k), ... $" src="form_176.png" width="66" height="15"/>)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppr</td><td>Input: pointer to precision structure </td></tr>
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure (will provide H, Omega_m at redshift of interest) </td></tr>
    <tr><td class="paramname">ppt</td><td>Input: pointer to perturbation structure </td></tr>
    <tr><td class="paramname">ptr</td><td>Input: pointer to transfer structure </td></tr>
    <tr><td class="paramname">ppm</td><td>Input: pointer to primordial structure </td></tr>
    <tr><td class="paramname">pfo</td><td>Input: pointer to fourier structure </td></tr>
    <tr><td class="paramname">phr</td><td>Output: pointer to initialized harmonic structure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<ul>
<li>check that we really want to compute at least one spectrum</li>
<li>initialize indices and allocate some of the arrays in the harmonic structure</li>
<li>deal with <img class="formulaInl" alt="$ C_l$" src="form_50.png" width="11" height="13"/>'s, if any</li>
<li>a pointer to the fourier structure is stored in the spectra structure. This odd, unusual and unelegant feature has been introduced in v2.8 in order to keep in use some deprecated functions harmonic_pk_...() that are now pointing at new function fourier_pk_...(). In the future, if the deprecated functions are removed, it will be possible to remove also this pointer.</li>
</ul>

</div>
</div>
<a id="afdc8979327b76cf83ce4c4fb35ade32e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afdc8979327b76cf83ce4c4fb35ade32e">&#9670;&nbsp;</a></span>harmonic_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int harmonic_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="harmonic_8h.html#structharmonic">harmonic</a> *&#160;</td>
          <td class="paramname"><em>phr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This routine frees all the memory space allocated by <a class="el" href="harmonic_8c.html#a067c78b424fcde741b3c73658ccdc99e">harmonic_init()</a>.</p>
<p>To be called at the end of each run, only when no further calls to harmonic_cls_at_l(), <a class="el" href="harmonic_8c.html#aa401dd2909f2d4d7be55bf64ae665545">harmonic_pk_at_z()</a>, <a class="el" href="harmonic_8c.html#a263f7c692bac02179a9be3aa3a47109e">harmonic_pk_at_k_and_z()</a> are needed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">phr</td><td>Input: pointer to harmonic structure (which fields must be freed) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>

</div>
</div>
<a id="aad0d37aea47fab7fe3149c0a78e7a675"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad0d37aea47fab7fe3149c0a78e7a675">&#9670;&nbsp;</a></span>harmonic_indices()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int harmonic_indices </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="background_8h.html#structbackground">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *&#160;</td>
          <td class="paramname"><em>ppt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="primordial_8h.html#structprimordial">primordial</a> *&#160;</td>
          <td class="paramname"><em>ppm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="harmonic_8h.html#structharmonic">harmonic</a> *&#160;</td>
          <td class="paramname"><em>phr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This routine defines indices and allocates tables in the harmonic structure</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">ppt</td><td>Input: pointer to perturbation structure </td></tr>
    <tr><td class="paramname">ptr</td><td>Input: pointer to transfer structure </td></tr>
    <tr><td class="paramname">ppm</td><td>Input: pointer to primordial structure </td></tr>
    <tr><td class="paramname">phr</td><td>Input/output: pointer to harmonic structure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>

</div>
</div>
<a id="a0d1bdfd25afb6aa6c2ec4c71eb35849f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d1bdfd25afb6aa6c2ec4c71eb35849f">&#9670;&nbsp;</a></span>harmonic_cls()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int harmonic_cls </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="background_8h.html#structbackground">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *&#160;</td>
          <td class="paramname"><em>ppt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="primordial_8h.html#structprimordial">primordial</a> *&#160;</td>
          <td class="paramname"><em>ppm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="harmonic_8h.html#structharmonic">harmonic</a> *&#160;</td>
          <td class="paramname"><em>phr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This routine computes a table of values for all harmonic spectra <img class="formulaInl" alt="$ C_l $" src="form_70.png" width="11" height="13"/>'s, given the transfer functions and primordial spectra.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">ppt</td><td>Input: pointer to perturbation structure </td></tr>
    <tr><td class="paramname">ptr</td><td>Input: pointer to transfer structure </td></tr>
    <tr><td class="paramname">ppm</td><td>Input: pointer to primordial structure </td></tr>
    <tr><td class="paramname">phr</td><td>Input/Output: pointer to harmonic structure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<ul>
<li>define local variables</li>
<li>allocate pointers to arrays where results will be stored</li>
<li>store values of l</li>
<li>loop over modes (scalar, tensors, etc). For each mode:</li>
<li>--&gt; (a) store number of l values for this mode</li>
<li>--&gt; (b) allocate arrays where results will be stored</li>
<li>--&gt; (c) loop over initial conditions</li>
<li>&mdash;&gt; loop over l values defined in the transfer module. For each l, compute the <img class="formulaInl" alt="$ C_l$" src="form_50.png" width="11" height="13"/>'s for all types (TT, TE, ...) by convolving primordial spectra with transfer functions. This elementary task is assigned to <a class="el" href="harmonic_8c.html#a3b511f641287b6959961b806dc048486">harmonic_compute_cl()</a></li>
<li>--&gt; (d) now that for a given mode, all possible <img class="formulaInl" alt="$ C_l$" src="form_50.png" width="11" height="13"/>'s have been computed, compute second derivative of the array in which they are stored, in view of spline interpolation.</li>
</ul>

</div>
</div>
<a id="a3b511f641287b6959961b806dc048486"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b511f641287b6959961b806dc048486">&#9670;&nbsp;</a></span>harmonic_compute_cl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int harmonic_compute_cl </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="background_8h.html#structbackground">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *&#160;</td>
          <td class="paramname"><em>ppt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="primordial_8h.html#structprimordial">primordial</a> *&#160;</td>
          <td class="paramname"><em>ppm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="harmonic_8h.html#structharmonic">harmonic</a> *&#160;</td>
          <td class="paramname"><em>phr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_md</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_ic1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_ic2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cl_integrand_num_columns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>cl_integrand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>primordial_pk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>transfer_ic1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>transfer_ic2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This routine computes the <img class="formulaInl" alt="$ C_l$" src="form_50.png" width="11" height="13"/>'s for a given mode, pair of initial conditions and multipole, but for all types (TT, TE...), by convolving the transfer functions with the primordial spectra.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">ppt</td><td>Input: pointer to perturbation structure </td></tr>
    <tr><td class="paramname">ptr</td><td>Input: pointer to transfer structure </td></tr>
    <tr><td class="paramname">ppm</td><td>Input: pointer to primordial structure </td></tr>
    <tr><td class="paramname">phr</td><td>Input/Output: pointer to harmonic structure (result stored here) </td></tr>
    <tr><td class="paramname">index_md</td><td>Input: index of mode under consideration </td></tr>
    <tr><td class="paramname">index_ic1</td><td>Input: index of first initial condition in the correlator </td></tr>
    <tr><td class="paramname">index_ic2</td><td>Input: index of second initial condition in the correlator </td></tr>
    <tr><td class="paramname">index_l</td><td>Input: index of multipole under consideration </td></tr>
    <tr><td class="paramname">cl_integrand_num_columns</td><td>Input: number of columns in cl_integrand </td></tr>
    <tr><td class="paramname">cl_integrand</td><td>Input: an allocated workspace </td></tr>
    <tr><td class="paramname">primordial_pk</td><td>Input: table of primordial spectrum values </td></tr>
    <tr><td class="paramname">transfer_ic1</td><td>Input: table of transfer function values for first initial condition </td></tr>
    <tr><td class="paramname">transfer_ic2</td><td>Input: table of transfer function values for second initial condition </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>

</div>
</div>
<a id="aa401dd2909f2d4d7be55bf64ae665545"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa401dd2909f2d4d7be55bf64ae665545">&#9670;&nbsp;</a></span>harmonic_pk_at_z()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int harmonic_pk_at_z </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="background_8h.html#structbackground">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="harmonic_8h.html#structharmonic">harmonic</a> *&#160;</td>
          <td class="paramname"><em>phr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="primordial_8h.html#af97c57fb2cbf4f53e76a1c0ddfb04322">linear_or_logarithmic</a>&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>output_tot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>output_ic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>output_cb_tot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>output_cb_ic</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Matter power spectrum for arbitrary redshift and for all initial conditions.</p>
<p>This function is deprecated since v2.8. Try using <a class="el" href="fourier_8c.html#abc24df77edd0d387448bc677280d05d5">fourier_pk_at_z()</a> instead.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure (used for converting z into tau) </td></tr>
    <tr><td class="paramname">phr</td><td>Input: pointer to harmonic structure (containing pre-computed table) </td></tr>
    <tr><td class="paramname">mode</td><td>Input: linear or logarithmic </td></tr>
    <tr><td class="paramname">z</td><td>Input: redshift </td></tr>
    <tr><td class="paramname">output_tot</td><td>Output: total matter power spectrum P(k) in <img class="formulaInl" alt="$ Mpc^3 $" src="form_284.png" width="30" height="14"/> (linear mode), or its logarithms (logarithmic mode) </td></tr>
    <tr><td class="paramname">output_ic</td><td>Output: for each pair of initial conditions, matter power spectra P(k) in <img class="formulaInl" alt="$ Mpc^3 $" src="form_284.png" width="30" height="14"/> (linear mode), or their logarithms and cross-correlation angles (logarithmic mode) </td></tr>
    <tr><td class="paramname">output_cb_tot</td><td>Output: CDM+baryon power spectrum P_cb(k) in <img class="formulaInl" alt="$ Mpc^3 $" src="form_284.png" width="30" height="14"/> (linear mode), or its logarithms (logarithmic mode) </td></tr>
    <tr><td class="paramname">output_cb_ic</td><td>Output: for each pair of initial conditions, CDM+baryon power spectra P_cb(k) in <img class="formulaInl" alt="$ Mpc^3 $" src="form_284.png" width="30" height="14"/> (linear mode), or their logarithms and cross-correlation angles (logarithmic mode) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>

</div>
</div>
<a id="a263f7c692bac02179a9be3aa3a47109e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a263f7c692bac02179a9be3aa3a47109e">&#9670;&nbsp;</a></span>harmonic_pk_at_k_and_z()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int harmonic_pk_at_k_and_z </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="background_8h.html#structbackground">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="primordial_8h.html#structprimordial">primordial</a> *&#160;</td>
          <td class="paramname"><em>ppm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="harmonic_8h.html#structharmonic">harmonic</a> *&#160;</td>
          <td class="paramname"><em>phr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>pk_tot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>pk_ic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>pk_cb_tot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>pk_cb_ic</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Matter power spectrum for arbitrary wavenumber, redshift and initial condition.</p>
<p>This function is deprecated since v2.8. Try using fourier_pk_linear_at_k_and_z() instead.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure (used for converting z into tau) </td></tr>
    <tr><td class="paramname">ppm</td><td>Input: pointer to primordial structure (used only in the case 0 &lt; k &lt; kmin) </td></tr>
    <tr><td class="paramname">phr</td><td>Input: pointer to harmonic structure (containing pre-computed table) </td></tr>
    <tr><td class="paramname">k</td><td>Input: wavenumber in 1/Mpc </td></tr>
    <tr><td class="paramname">z</td><td>Input: redshift </td></tr>
    <tr><td class="paramname">pk_tot</td><td>Output: total matter power spectrum P(k) in <img class="formulaInl" alt="$ Mpc^3 $" src="form_284.png" width="30" height="14"/> </td></tr>
    <tr><td class="paramname">pk_ic</td><td>Output: for each pair of initial conditions, matter power spectra P(k) in <img class="formulaInl" alt="$ Mpc^3$" src="form_285.png" width="30" height="14"/> </td></tr>
    <tr><td class="paramname">pk_cb_tot</td><td>Output: b+CDM power spectrum P(k) in <img class="formulaInl" alt="$ Mpc^3 $" src="form_284.png" width="30" height="14"/> </td></tr>
    <tr><td class="paramname">pk_cb_ic</td><td>Output: for each pair of initial conditions, b+CDM power spectra P(k) in <img class="formulaInl" alt="$ Mpc^3$" src="form_285.png" width="30" height="14"/> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>

</div>
</div>
<a id="a2e15977952a0ae55ec39a19da2d148c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e15977952a0ae55ec39a19da2d148c4">&#9670;&nbsp;</a></span>harmonic_pk_nl_at_z()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int harmonic_pk_nl_at_z </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="background_8h.html#structbackground">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="harmonic_8h.html#structharmonic">harmonic</a> *&#160;</td>
          <td class="paramname"><em>phr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="primordial_8h.html#af97c57fb2cbf4f53e76a1c0ddfb04322">linear_or_logarithmic</a>&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>output_tot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>output_cb_tot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Non-linear total matter power spectrum for arbitrary redshift.</p>
<p>This function is deprecated since v2.8. Try using <a class="el" href="fourier_8c.html#abc24df77edd0d387448bc677280d05d5">fourier_pk_at_z()</a> instead.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure (used for converting z into tau) </td></tr>
    <tr><td class="paramname">phr</td><td>Input: pointer to harmonic structure (containing pre-computed table) </td></tr>
    <tr><td class="paramname">mode</td><td>Input: linear or logarithmic </td></tr>
    <tr><td class="paramname">z</td><td>Input: redshift </td></tr>
    <tr><td class="paramname">output_tot</td><td>Output: total matter power spectrum P(k) in <img class="formulaInl" alt="$ Mpc^3$" src="form_285.png" width="30" height="14"/> (linear mode), or its logarithms (logarithmic mode) </td></tr>
    <tr><td class="paramname">output_cb_tot</td><td>Output: b+CDM power spectrum P(k) in <img class="formulaInl" alt="$ Mpc^3$" src="form_285.png" width="30" height="14"/> (linear mode), or its logarithms (logarithmic mode) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>

</div>
</div>
<a id="a82e695a8ed2b6cbbddda56875ed38d55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82e695a8ed2b6cbbddda56875ed38d55">&#9670;&nbsp;</a></span>harmonic_pk_nl_at_k_and_z()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int harmonic_pk_nl_at_k_and_z </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="background_8h.html#structbackground">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="primordial_8h.html#structprimordial">primordial</a> *&#160;</td>
          <td class="paramname"><em>ppm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="harmonic_8h.html#structharmonic">harmonic</a> *&#160;</td>
          <td class="paramname"><em>phr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>pk_tot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>pk_cb_tot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Non-linear total matter power spectrum for arbitrary wavenumber and redshift.</p>
<p>This function is deprecated since v2.8. Try using <a class="el" href="fourier_8c.html#a923a2a2b4443953bc7c27bc3bc7aae18">fourier_pk_at_k_and_z()</a> instead.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure (used for converting z into tau) </td></tr>
    <tr><td class="paramname">ppm</td><td>Input: pointer to primordial structure (used only in the case 0 &lt; k &lt; kmin) </td></tr>
    <tr><td class="paramname">phr</td><td>Input: pointer to harmonic structure (containing pre-computed table) </td></tr>
    <tr><td class="paramname">k</td><td>Input: wavenumber in 1/Mpc </td></tr>
    <tr><td class="paramname">z</td><td>Input: redshift </td></tr>
    <tr><td class="paramname">pk_tot</td><td>Output: total matter power spectrum P(k) in <img class="formulaInl" alt="$ Mpc^3$" src="form_285.png" width="30" height="14"/> </td></tr>
    <tr><td class="paramname">pk_cb_tot</td><td>Output: b+CDM power spectrum P(k) in <img class="formulaInl" alt="$ Mpc^3$" src="form_285.png" width="30" height="14"/> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>

</div>
</div>
<a id="a3b1b28df71e0f0bb4757898997cb3918"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b1b28df71e0f0bb4757898997cb3918">&#9670;&nbsp;</a></span>harmonic_fast_pk_at_kvec_and_zvec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int harmonic_fast_pk_at_kvec_and_zvec </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="background_8h.html#structbackground">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="harmonic_8h.html#structharmonic">harmonic</a> *&#160;</td>
          <td class="paramname"><em>phr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>kvec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>kvec_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>zvec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>zvec_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>pk_tot_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>pk_cb_tot_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nonlinear</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the P(k,z) for a grid of (k_i,z_j) passed in input, for all available pk types (_m, _cb), either linear or nonlinear depending on input.</p>
<p>This function is deprecated since v2.8. Try using <a class="el" href="fourier_8c.html#a068abe93ced762d7ef98bd9e823a1fe5">fourier_pks_at_kvec_and_zvec()</a> instead.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">phr</td><td>Input: pointer to harmonic structure </td></tr>
    <tr><td class="paramname">kvec</td><td>Input: array of wavenumbers in ascending order (in 1/Mpc) </td></tr>
    <tr><td class="paramname">kvec_size</td><td>Input: size of array of wavenumbers </td></tr>
    <tr><td class="paramname">zvec</td><td>Input: array of redshifts in arbitrary order </td></tr>
    <tr><td class="paramname">zvec_size</td><td>Input: size of array of redshifts </td></tr>
    <tr><td class="paramname">pk_tot_out</td><td>Output: P(k_i,z_j) for total matter (if available) in Mpc**3 </td></tr>
    <tr><td class="paramname">pk_cb_tot_out</td><td>Output: P_cb(k_i,z_j) for cdm+baryons (if available) in Mpc**3 </td></tr>
    <tr><td class="paramname">nonlinear</td><td>Input: <em>TRUE</em> or <em>FALSE</em> (to output nonlinear or linear P(k,z)) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>

</div>
</div>
<a id="a3e5acde2947e419e828417896cd786c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e5acde2947e419e828417896cd786c7">&#9670;&nbsp;</a></span>harmonic_sigma()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int harmonic_sigma </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="background_8h.html#structbackground">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="primordial_8h.html#structprimordial">primordial</a> *&#160;</td>
          <td class="paramname"><em>ppm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="harmonic_8h.html#structharmonic">harmonic</a> *&#160;</td>
          <td class="paramname"><em>phr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>R</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>sigma</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This routine computes sigma(R) given P(k) for total matter power spectrum (does not check that k_max is large enough)</p>
<p>This function is deprecated since v2.8. Try using <a class="el" href="fourier_8c.html#a7d971164695b3ba6cd8f979a4d2c65dd">fourier_sigmas_at_z()</a> instead.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">ppm</td><td>Input: pointer to primordial structure </td></tr>
    <tr><td class="paramname">phr</td><td>Input: pointer to harmonic structure </td></tr>
    <tr><td class="paramname">R</td><td>Input: radius in Mpc </td></tr>
    <tr><td class="paramname">z</td><td>Input: redshift </td></tr>
    <tr><td class="paramname">sigma</td><td>Output: variance in a sphere of radius R (dimensionless) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>

</div>
</div>
<a id="a9fde5b2875b452a59a94f8a291e91c29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fde5b2875b452a59a94f8a291e91c29">&#9670;&nbsp;</a></span>harmonic_sigma_cb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int harmonic_sigma_cb </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="background_8h.html#structbackground">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="primordial_8h.html#structprimordial">primordial</a> *&#160;</td>
          <td class="paramname"><em>ppm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="harmonic_8h.html#structharmonic">harmonic</a> *&#160;</td>
          <td class="paramname"><em>phr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>R</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>sigma_cb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This routine computes sigma(R) given P(k) for baryon+cdm power spectrum (does not check that k_max is large enough)</p>
<p>This function is deprecated since v2.8. Try using <a class="el" href="fourier_8c.html#a7d971164695b3ba6cd8f979a4d2c65dd">fourier_sigmas_at_z()</a> instead.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">ppm</td><td>Input: pointer to primordial structure </td></tr>
    <tr><td class="paramname">phr</td><td>Input: pointer to harmonic structure </td></tr>
    <tr><td class="paramname">R</td><td>Input: radius in Mpc </td></tr>
    <tr><td class="paramname">z</td><td>Input: redshift </td></tr>
    <tr><td class="paramname">sigma_cb</td><td>Output: variance in a sphere of radius R (dimensionless) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>

</div>
</div>
<a id="a9b2ed426d396fb5900fcea5acbf103ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b2ed426d396fb5900fcea5acbf103ee">&#9670;&nbsp;</a></span>harmonic_tk_at_z()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int harmonic_tk_at_z </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="background_8h.html#structbackground">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="harmonic_8h.html#structharmonic">harmonic</a> *&#160;</td>
          <td class="paramname"><em>phr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Obsolete function, superseeded by <a class="el" href="perturbations_8c.html#af4392d84c4f89c316844cac929e741e8">perturbations_sources_at_tau()</a> (at the time of the switch, this function was anyway never used anywhere)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure (used for converting z into tau) </td></tr>
    <tr><td class="paramname">phr</td><td>Input: pointer to harmonic structure (containing pre-computed table) </td></tr>
    <tr><td class="paramname">z</td><td>Input: redshift </td></tr>
    <tr><td class="paramname">output</td><td>Output: matter transfer functions </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>

</div>
</div>
<a id="a43180bf64486df5b523fb90a6e3a36b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43180bf64486df5b523fb90a6e3a36b8">&#9670;&nbsp;</a></span>harmonic_tk_at_k_and_z()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int harmonic_tk_at_k_and_z </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="background_8h.html#structbackground">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="harmonic_8h.html#structharmonic">harmonic</a> *&#160;</td>
          <td class="paramname"><em>phr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Obsolete function, superseeded by <a class="el" href="perturbations_8c.html#af4392d84c4f89c316844cac929e741e8">perturbations_sources_at_tau()</a> (at the time of the switch, this function was anyway never used anywhere)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure (used for converting z into tau) </td></tr>
    <tr><td class="paramname">phr</td><td>Input: pointer to harmonic structure (containing pre-computed table) </td></tr>
    <tr><td class="paramname">k</td><td>Input: wavenumber in 1/Mpc </td></tr>
    <tr><td class="paramname">z</td><td>Input: redshift </td></tr>
    <tr><td class="paramname">output</td><td>Output: matter transfer functions </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="harmonic_8c.html">harmonic.c</a></li>
    <li class="footer">Generated on Wed Sep 29 2021 16:27:41 for CLASS MANUAL by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>

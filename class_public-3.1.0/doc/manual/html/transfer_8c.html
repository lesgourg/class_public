<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CLASS MANUAL: transfer.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CLASS MANUAL
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('transfer_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">transfer.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="transfer_8h_source.html">transfer.h</a>&quot;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for transfer.c:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="transfer_8c__incl.png" border="0" usemap="#atransfer_8c" alt=""/></div>
<map name="atransfer_8c" id="atransfer_8c">
<area shape="rect" title=" " alt="" coords="969,5,1045,32"/>
<area shape="rect" href="transfer_8h.html" title=" " alt="" coords="969,80,1045,107"/>
<area shape="rect" href="fourier_8h.html" title=" " alt="" coords="811,155,879,181"/>
<area shape="rect" href="hyperspherical_8h_source.html" title=" " alt="" coords="894,304,1011,331"/>
<area shape="rect" title=" " alt="" coords="966,155,1049,181"/>
<area shape="rect" title=" " alt="" coords="1073,155,1153,181"/>
<area shape="rect" title=" " alt="" coords="1177,155,1240,181"/>
<area shape="rect" href="primordial_8h.html" title=" " alt="" coords="713,229,803,256"/>
<area shape="rect" href="trigonometric__integrals_8h_source.html" title=" " alt="" coords="763,379,927,405"/>
<area shape="rect" href="perturbations_8h.html" title=" " alt="" coords="617,304,725,331"/>
<area shape="rect" href="thermodynamics_8h.html" title=" " alt="" coords="524,379,653,405"/>
<area shape="rect" href="background_8h.html" title=" " alt="" coords="144,453,244,480"/>
<area shape="rect" href="evolver__ndf15_8h_source.html" title=" " alt="" coords="399,453,514,480"/>
<area shape="rect" href="evolver__rkck_8h_source.html" title=" " alt="" coords="269,453,375,480"/>
<area shape="rect" title=" " alt="" coords="539,453,639,480"/>
<area shape="rect" href="wrap__recfast_8h_source.html" title=" " alt="" coords="663,453,771,480"/>
<area shape="rect" href="injection_8h_source.html" title=" " alt="" coords="795,453,876,480"/>
<area shape="rect" href="common_8h.html" title=" " alt="" coords="529,603,611,629"/>
<area shape="rect" href="quadrature_8h_source.html" title=" " alt="" coords="28,528,123,555"/>
<area shape="rect" title=" " alt="" coords="147,528,239,555"/>
<area shape="rect" href="arrays_8h_source.html" title=" " alt="" coords="263,528,333,555"/>
<area shape="rect" href="dei__rkck_8h_source.html" title=" " alt="" coords="450,528,533,555"/>
<area shape="rect" href="parser_8h_source.html" title=" " alt="" coords="357,528,425,555"/>
<area shape="rect" title=" " alt="" coords="234,677,295,704"/>
<area shape="rect" title=" " alt="" coords="319,677,383,704"/>
<area shape="rect" title=" " alt="" coords="408,677,471,704"/>
<area shape="rect" title=" " alt="" coords="495,677,560,704"/>
<area shape="rect" title=" " alt="" coords="585,677,643,704"/>
<area shape="rect" href="svnversion_8h_source.html" title=" " alt="" coords="667,677,763,704"/>
<area shape="rect" title=" " alt="" coords="787,677,857,704"/>
<area shape="rect" href="precisions_8h_source.html" title=" " alt="" coords="881,677,973,704"/>
<area shape="rect" href="macros__precision_8h_source.html" title=" " alt="" coords="860,752,995,779"/>
<area shape="rect" href="sparse_8h_source.html" title=" " alt="" coords="607,528,679,555"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a29d82c307d29a5dd4292b4909203db05"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#a29d82c307d29a5dd4292b4909203db05">transfer_functions_at_q</a> (struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *ptr, int index_md, int index_ic, int index_tt, int index_l, double q, double *transfer_function)</td></tr>
<tr class="separator:a29d82c307d29a5dd4292b4909203db05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96f1a37539a8a452fa71ef3971909bb2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#a96f1a37539a8a452fa71ef3971909bb2">transfer_init</a> (struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="background_8h.html#structbackground">background</a> *pba, struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *pth, struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *ppt, struct <a class="el" href="fourier_8h.html#structfourier">fourier</a> *pfo, struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *ptr)</td></tr>
<tr class="separator:a96f1a37539a8a452fa71ef3971909bb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae24c6418bd6d1f7139d6e605377296e2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#ae24c6418bd6d1f7139d6e605377296e2">transfer_free</a> (struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *ptr)</td></tr>
<tr class="separator:ae24c6418bd6d1f7139d6e605377296e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a628efeb9ab413b89c3dc2b25376b5a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#a5a628efeb9ab413b89c3dc2b25376b5a">transfer_indices</a> (struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *ppt, struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *ptr, double q_period, double K, int sgnK)</td></tr>
<tr class="separator:a5a628efeb9ab413b89c3dc2b25376b5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8eb4d428a1357067a5461b83ba9f38a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#ae8eb4d428a1357067a5461b83ba9f38a">transfer_get_l_list</a> (struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *ppt, struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *ptr)</td></tr>
<tr class="separator:ae8eb4d428a1357067a5461b83ba9f38a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c7c481c8ab3aef8443abe2a5be448da"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#a6c7c481c8ab3aef8443abe2a5be448da">transfer_get_q_list</a> (struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *ppt, struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *ptr, double q_period, double K, int sgnK)</td></tr>
<tr class="separator:a6c7c481c8ab3aef8443abe2a5be448da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50c4b6677695859b33d621cf9ea372f3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#a50c4b6677695859b33d621cf9ea372f3">transfer_get_k_list</a> (struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *ppt, struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *ptr, double K)</td></tr>
<tr class="separator:a50c4b6677695859b33d621cf9ea372f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44fe362b3b3d5cb7c2cf2ee5cf6a4267"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#a44fe362b3b3d5cb7c2cf2ee5cf6a4267">transfer_get_source_correspondence</a> (struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *ppt, struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *ptr, int **tp_of_tt)</td></tr>
<tr class="separator:a44fe362b3b3d5cb7c2cf2ee5cf6a4267"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ed3e182de457eab4dd07251e8ae7e4d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#a5ed3e182de457eab4dd07251e8ae7e4d">transfer_source_tau_size</a> (struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="background_8h.html#structbackground">background</a> *pba, struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *ppt, struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *ptr, double tau_rec, double tau0, int index_md, int index_tt, int *tau_size)</td></tr>
<tr class="separator:a5ed3e182de457eab4dd07251e8ae7e4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4dadab78fbaa9c977ed4e5e7f507fc6a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#a4dadab78fbaa9c977ed4e5e7f507fc6a">transfer_compute_for_each_q</a> (struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="background_8h.html#structbackground">background</a> *pba, struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *ppt, struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *ptr, int **tp_of_tt, int index_q, int tau_size_max, double tau_rec, double ***pert_sources, double ***pert_sources_spline, double *window, struct <a class="el" href="transfer_8h.html#structtransfer__workspace">transfer_workspace</a> *ptw)</td></tr>
<tr class="separator:a4dadab78fbaa9c977ed4e5e7f507fc6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ba2dead90573339ccc54b63d8a58989"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#a5ba2dead90573339ccc54b63d8a58989">transfer_interpolate_sources</a> (struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *ppt, struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *ptr, int index_q, int index_md, int index_ic, int index_type, double *pert_source, double *pert_source_spline, double *interpolated_sources)</td></tr>
<tr class="separator:a5ba2dead90573339ccc54b63d8a58989"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d21f13ccec1a296e472efb7023f2d06"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#a5d21f13ccec1a296e472efb7023f2d06">transfer_sources</a> (struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="background_8h.html#structbackground">background</a> *pba, struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *ppt, struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *ptr, double *interpolated_sources, double tau_rec, int index_q, int index_md, int index_tt, double *sources, double *window, int tau_size_max, double *tau0_minus_tau, double *w_trapz, int *tau_size_out)</td></tr>
<tr class="separator:a5d21f13ccec1a296e472efb7023f2d06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad91b311d6f1a765f1346a0ded531f4c8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#ad91b311d6f1a765f1346a0ded531f4c8">transfer_selection_function</a> (struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *ppt, struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *ptr, int bin, double z, double *selection)</td></tr>
<tr class="separator:ad91b311d6f1a765f1346a0ded531f4c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75d06ef89c95bc798cdab8f1ca6d0426"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#a75d06ef89c95bc798cdab8f1ca6d0426">transfer_dNdz_analytic</a> (struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *ptr, double z, double *dNdz, double *dln_dNdz_dz)</td></tr>
<tr class="separator:a75d06ef89c95bc798cdab8f1ca6d0426"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a651dd7133c0206ffe6ae145718efe19b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#a651dd7133c0206ffe6ae145718efe19b">transfer_selection_sampling</a> (struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="background_8h.html#structbackground">background</a> *pba, struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *ppt, struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *ptr, int bin, double *tau0_minus_tau, int tau_size)</td></tr>
<tr class="separator:a651dd7133c0206ffe6ae145718efe19b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac837fa21a9bc43da13eca67cb6f48539"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#ac837fa21a9bc43da13eca67cb6f48539">transfer_lensing_sampling</a> (struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="background_8h.html#structbackground">background</a> *pba, struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *ppt, struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *ptr, int bin, double tau0, double *tau0_minus_tau, int tau_size)</td></tr>
<tr class="separator:ac837fa21a9bc43da13eca67cb6f48539"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad370b084d1580c8dc159b1c71d7d4e54"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#ad370b084d1580c8dc159b1c71d7d4e54">transfer_source_resample</a> (struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="background_8h.html#structbackground">background</a> *pba, struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *ppt, struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *ptr, int bin, double *tau0_minus_tau, int tau_size, int index_md, double tau0, double *interpolated_sources, double *sources)</td></tr>
<tr class="separator:ad370b084d1580c8dc159b1c71d7d4e54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93bc176ac659dad26e2badd12145d572"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#a93bc176ac659dad26e2badd12145d572">transfer_selection_times</a> (struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="background_8h.html#structbackground">background</a> *pba, struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *ppt, struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *ptr, int bin, double *tau_min, double *tau_mean, double *tau_max)</td></tr>
<tr class="separator:a93bc176ac659dad26e2badd12145d572"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af896822157edf6f646a70e9cf558c554"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#af896822157edf6f646a70e9cf558c554">transfer_selection_compute</a> (struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="background_8h.html#structbackground">background</a> *pba, struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *ppt, struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *ptr, double *selection, double *tau0_minus_tau, double *w_trapz, int tau_size, double *pvecback, double tau0, int bin)</td></tr>
<tr class="separator:af896822157edf6f646a70e9cf558c554"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1874eaa8665d73548229b64972765cc5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#a1874eaa8665d73548229b64972765cc5">transfer_compute_for_each_l</a> (struct <a class="el" href="transfer_8h.html#structtransfer__workspace">transfer_workspace</a> *ptw, struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *ppt, struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *ptr, int index_q, int index_md, int index_ic, int index_tt, int index_l, double l, double q_max_bessel, <a class="el" href="transfer_8h.html#af3f4670b8918a9905edf8d0c2c5ce32b">radial_function_type</a> radial_type)</td></tr>
<tr class="separator:a1874eaa8665d73548229b64972765cc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6122e71134ade9774074a3f722f1f3f5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#a6122e71134ade9774074a3f722f1f3f5">transfer_integrate</a> (struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *ppt, struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *ptr, struct <a class="el" href="transfer_8h.html#structtransfer__workspace">transfer_workspace</a> *ptw, int index_q, int index_md, int index_tt, double l, int index_l, double k, <a class="el" href="transfer_8h.html#af3f4670b8918a9905edf8d0c2c5ce32b">radial_function_type</a> radial_type, double *trsf)</td></tr>
<tr class="separator:a6122e71134ade9774074a3f722f1f3f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9858d7e498a713479d1243456afc74ae"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#a9858d7e498a713479d1243456afc74ae">transfer_limber</a> (struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *ptr, struct <a class="el" href="transfer_8h.html#structtransfer__workspace">transfer_workspace</a> *ptw, int index_md, int index_q, double l, double q, <a class="el" href="transfer_8h.html#af3f4670b8918a9905edf8d0c2c5ce32b">radial_function_type</a> radial_type, double *trsf)</td></tr>
<tr class="separator:a9858d7e498a713479d1243456afc74ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0708236ad3535c319b9ca9c055f96615"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#a0708236ad3535c319b9ca9c055f96615">transfer_limber_interpolate</a> (struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *ptr, double *tau0_minus_tau, double *sources, int tau_size, double tau0_minus_tau_limber, double *S)</td></tr>
<tr class="separator:a0708236ad3535c319b9ca9c055f96615"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a796ce542bdd1305b6ee679e0836471b9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#a796ce542bdd1305b6ee679e0836471b9">transfer_limber2</a> (int tau_size, struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *ptr, int index_md, int index_k, double l, double k, double *tau0_minus_tau, double *sources, <a class="el" href="transfer_8h.html#af3f4670b8918a9905edf8d0c2c5ce32b">radial_function_type</a> radial_type, double *trsf)</td></tr>
<tr class="separator:a796ce542bdd1305b6ee679e0836471b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad72ae14480a39fa4db9a33e48ccb206f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="transfer_8c.html#ad72ae14480a39fa4db9a33e48ccb206f">transfer_precompute_selection</a> (struct <a class="el" href="common_8h.html#structprecision">precision</a> *ppr, struct <a class="el" href="background_8h.html#structbackground">background</a> *pba, struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *ppt, struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *ptr, double tau_rec, int tau_size_max, double **window)</td></tr>
<tr class="separator:ad72ae14480a39fa4db9a33e48ccb206f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Documented transfer module.</p>
<p>Julien Lesgourgues, 28.07.2013</p>
<p>This module has two purposes:</p>
<ul>
<li>at the beginning, to compute the transfer functions <img class="formulaInl" alt="$ \Delta_l^{X} (q) $" src="form_137.png" width="35" height="15"/>, and store them in tables used for interpolation in other modules.</li>
<li>at any time in the code, to evaluate the transfer functions (for a given mode, initial condition, type and multipole l) at any wavenumber q (by interpolating within the interpolation table).</li>
</ul>
<p>Hence the following functions can be called from other modules:</p>
<ol type="1">
<li><a class="el" href="transfer_8c.html#a96f1a37539a8a452fa71ef3971909bb2">transfer_init()</a> at the beginning (but after <a class="el" href="perturbations_8c.html#a9ae14364feec938fec63603b1a0e2361">perturbations_init()</a> and bessel_init())</li>
<li><a class="el" href="transfer_8c.html#a29d82c307d29a5dd4292b4909203db05">transfer_functions_at_q()</a> at any later time</li>
<li><a class="el" href="transfer_8c.html#ae24c6418bd6d1f7139d6e605377296e2">transfer_free()</a> at the end, when no more calls to <a class="el" href="transfer_8c.html#a29d82c307d29a5dd4292b4909203db05">transfer_functions_at_q()</a> are needed</li>
</ol>
<p>Note that in the standard implementation of CLASS, only the pre-computed values of the transfer functions are used, no interpolation is necessary; hence the routine <a class="el" href="transfer_8c.html#a29d82c307d29a5dd4292b4909203db05">transfer_functions_at_q()</a> is actually never called. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a29d82c307d29a5dd4292b4909203db05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29d82c307d29a5dd4292b4909203db05">&#9670;&nbsp;</a></span>transfer_functions_at_q()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_functions_at_q </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_md</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_ic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_tt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>transfer_function</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Transfer function <img class="formulaInl" alt="$ \Delta_l^{X} (q) $" src="form_137.png" width="35" height="15"/> at a given wavenumber q.</p>
<p>For a given mode (scalar, vector, tensor), initial condition, type (temperature, polarization, lensing, etc) and multipole, computes the transfer function for an arbitrary value of q by interpolating between pre-computed values of q. This function can be called from whatever module at whatever time, provided that <a class="el" href="transfer_8c.html#a96f1a37539a8a452fa71ef3971909bb2">transfer_init()</a> has been called before, and <a class="el" href="transfer_8c.html#ae24c6418bd6d1f7139d6e605377296e2">transfer_free()</a> has not been called yet.</p>
<p>Wavenumbers are called q in this module and k in the perturbation module. In flat universes k=q. In non-flat universes q and k differ through <img class="formulaInl" alt="$ q2 = k2 + K(1+m)$" src="form_292.png" width="110" height="14"/>, where m=0,1,2 for scalar, vector, tensor. q should be used throughout the transfer module, excepted when interpolating or manipulating the source functions S(k,tau) calculated in the perturbation module: for a given value of q, this should be done at the corresponding k(q).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ptr</td><td>Input: pointer to transfer structure </td></tr>
    <tr><td class="paramname">index_md</td><td>Input: index of requested mode </td></tr>
    <tr><td class="paramname">index_ic</td><td>Input: index of requested initial condition </td></tr>
    <tr><td class="paramname">index_tt</td><td>Input: index of requested type </td></tr>
    <tr><td class="paramname">index_l</td><td>Input: index of requested multipole </td></tr>
    <tr><td class="paramname">q</td><td>Input: any wavenumber </td></tr>
    <tr><td class="paramname">transfer_function</td><td>Output: transfer function </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<ul>
<li>interpolate in pre-computed table using array_interpolate_two()</li>
</ul>

</div>
</div>
<a id="a96f1a37539a8a452fa71ef3971909bb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96f1a37539a8a452fa71ef3971909bb2">&#9670;&nbsp;</a></span>transfer_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_init </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="background_8h.html#structbackground">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="thermodynamics_8h.html#structthermodynamics">thermodynamics</a> *&#160;</td>
          <td class="paramname"><em>pth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *&#160;</td>
          <td class="paramname"><em>ppt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="fourier_8h.html#structfourier">fourier</a> *&#160;</td>
          <td class="paramname"><em>pfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This routine initializes the transfer structure, (in particular, computes table of transfer functions <img class="formulaInl" alt="$ \Delta_l^{X} (q) $" src="form_137.png" width="35" height="15"/>)</p>
<p>Main steps:</p>
<ul>
<li>initialize all indices in the transfer structure and allocate all its arrays using <a class="el" href="transfer_8c.html#a5a628efeb9ab413b89c3dc2b25376b5a">transfer_indices()</a>.</li>
<li>for each thread (in case of parallel run), initialize the fields of a memory zone called the <a class="el" href="transfer_8h.html#structtransfer__workspace">transfer_workspace</a> with transfer_workspace_init()</li>
<li>loop over q values. For each q, compute the Bessel functions if needed with transfer_update_HIS(), and defer the calculation of all transfer functions to <a class="el" href="transfer_8c.html#a4dadab78fbaa9c977ed4e5e7f507fc6a">transfer_compute_for_each_q()</a></li>
<li>for each thread, free the the workspace with transfer_workspace_free()</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppr</td><td>Input: pointer to precision structure </td></tr>
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">pth</td><td>Input: pointer to thermodynamics structure </td></tr>
    <tr><td class="paramname">ppt</td><td>Input: pointer to perturbation structure </td></tr>
    <tr><td class="paramname">pfo</td><td>Input: pointer to fourier structure </td></tr>
    <tr><td class="paramname">ptr</td><td>Output: pointer to initialized transfer structure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<ul>
<li>define local variables</li>
<li>array with the correspondence between the index of sources in the perturbation module and in the transfer module, tp_of_tt[index_md][index_tt]</li>
<li>check whether any spectrum in harmonic space (i.e., any <img class="formulaInl" alt="$C_l$" src="form_4.png" width="11" height="13"/>'s) is actually requested</li>
<li>get number of modes (scalars, tensors...)</li>
<li>get conformal age / recombination time from background / thermodynamics structures (only place where these structures are used in this module)</li>
<li>correspondence between k and l depend on angular diameter distance, i.e. on curvature.</li>
<li>order of magnitude of the oscillation period of transfer functions</li>
<li>initialize all indices in the transfer structure and allocate all its arrays using <a class="el" href="transfer_8c.html#a5a628efeb9ab413b89c3dc2b25376b5a">transfer_indices()</a></li>
<li>copy sources to a local array sources (in fact, only the pointers are copied, not the data), and eventually apply non-linear corrections to the sources</li>
<li>spline all the sources passed by the perturbation module with respect to k (in order to interpolate later at a given value of k)</li>
<li>allocate and fill array describing the correspondence between perturbation types and transfer types</li>
<li>evaluate maximum number of sampled times in the transfer sources: needs to be known here, in order to allocate a large enough workspace</li>
<li>compute flat spherical bessel functions</li>
<li>eventually read the selection and evolution functions</li>
<li>precompute window function for integrated nCl/sCl quantities</li>
<li>loop over all wavenumbers (parallelized).</li>
<li>finally, free arrays allocated outside parallel zone</li>
</ul>

</div>
</div>
<a id="ae24c6418bd6d1f7139d6e605377296e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae24c6418bd6d1f7139d6e605377296e2">&#9670;&nbsp;</a></span>transfer_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *&#160;</td>
          <td class="paramname"><em>ptr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This routine frees all the memory space allocated by <a class="el" href="transfer_8c.html#a96f1a37539a8a452fa71ef3971909bb2">transfer_init()</a>.</p>
<p>To be called at the end of each run, only when no further calls to transfer_functions_at_k() are needed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ptr</td><td>Input: pointer to transfer structure (which fields must be freed) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="transfer_8c_ae24c6418bd6d1f7139d6e605377296e2_cgraph.png" border="0" usemap="#atransfer_8c_ae24c6418bd6d1f7139d6e605377296e2_cgraph" alt=""/></div>
<map name="atransfer_8c_ae24c6418bd6d1f7139d6e605377296e2_cgraph" id="atransfer_8c_ae24c6418bd6d1f7139d6e605377296e2_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,100,32"/>
<area shape="rect" href="transfer_8h.html#ae9cf755fe7932a83d3e44c67f59a3c3f" title=" " alt="" coords="148,5,267,32"/>
</map>
</div>

</div>
</div>
<a id="a5a628efeb9ab413b89c3dc2b25376b5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a628efeb9ab413b89c3dc2b25376b5a">&#9670;&nbsp;</a></span>transfer_indices()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_indices </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *&#160;</td>
          <td class="paramname"><em>ppt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>q_period</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>K</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sgnK</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This routine defines all indices and allocates all tables in the transfer structure</p>
<p>Compute list of (k, l) values, allocate and fill corresponding arrays in the transfer structure. Allocate the array of transfer function tables.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppr</td><td>Input: pointer to precision structure </td></tr>
    <tr><td class="paramname">ppt</td><td>Input: pointer to perturbation structure </td></tr>
    <tr><td class="paramname">ptr</td><td>Input/Output: pointer to transfer structure </td></tr>
    <tr><td class="paramname">q_period</td><td>Input: order of magnitude of the oscillation period of transfer functions </td></tr>
    <tr><td class="paramname">K</td><td>Input: spatial curvature (in absolute value) </td></tr>
    <tr><td class="paramname">sgnK</td><td>Input: spatial curvature sign (open/closed/flat) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<ul>
<li>define local variables</li>
<li>define indices for transfer types</li>
<li>type indices common to scalars and tensors</li>
<li>type indices for scalars</li>
<li>type indices for vectors</li>
<li>type indices for tensors</li>
<li>allocate arrays of (k, l) values and transfer functions</li>
<li>get q values using <a class="el" href="transfer_8c.html#a6c7c481c8ab3aef8443abe2a5be448da">transfer_get_q_list()</a></li>
<li>get k values using <a class="el" href="transfer_8c.html#a50c4b6677695859b33d621cf9ea372f3">transfer_get_k_list()</a></li>
<li>get l values using <a class="el" href="transfer_8c.html#ae8eb4d428a1357067a5461b83ba9f38a">transfer_get_l_list()</a></li>
<li>loop over modes (scalar, etc). For each mode:</li>
<li>allocate arrays of transfer functions, (ptr-&gt;transfer[index_md])[index_ic][index_tt][index_l][index_k]</li>
</ul>

</div>
</div>
<a id="ae8eb4d428a1357067a5461b83ba9f38a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8eb4d428a1357067a5461b83ba9f38a">&#9670;&nbsp;</a></span>transfer_get_l_list()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_get_l_list </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *&#160;</td>
          <td class="paramname"><em>ppt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This routine defines the number and values of multipoles l for all modes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppr</td><td>Input: pointer to precision structure </td></tr>
    <tr><td class="paramname">ppt</td><td>Input: pointer to perturbation structure </td></tr>
    <tr><td class="paramname">ptr</td><td>Input/Output: pointer to transfer structure containing l's </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<ul>
<li>allocate and fill l array</li>
<li>start from l = 2 and increase with logarithmic step</li>
<li>when the logarithmic step becomes larger than some linear step, stick to this linear step till l_max</li>
<li>last value set to exactly l_max</li>
<li>so far we just counted the number of values. Now repeat the whole thing but fill array with values.</li>
</ul>

</div>
</div>
<a id="a6c7c481c8ab3aef8443abe2a5be448da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c7c481c8ab3aef8443abe2a5be448da">&#9670;&nbsp;</a></span>transfer_get_q_list()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_get_q_list </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *&#160;</td>
          <td class="paramname"><em>ppt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>q_period</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>K</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sgnK</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This routine defines the number and values of wavenumbers q for each mode (goes smoothly from logarithmic step for small q's to linear step for large q's).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppr</td><td>Input: pointer to precision structure </td></tr>
    <tr><td class="paramname">ppt</td><td>Input: pointer to perturbation structure </td></tr>
    <tr><td class="paramname">ptr</td><td>Input/Output: pointer to transfer structure containing q's </td></tr>
    <tr><td class="paramname">q_period</td><td>Input: order of magnitude of the oscillation period of transfer functions </td></tr>
    <tr><td class="paramname">K</td><td>Input: spatial curvature (in absolute value) </td></tr>
    <tr><td class="paramname">sgnK</td><td>Input: spatial curvature sign (open/closed/flat) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>

</div>
</div>
<a id="a50c4b6677695859b33d621cf9ea372f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50c4b6677695859b33d621cf9ea372f3">&#9670;&nbsp;</a></span>transfer_get_k_list()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_get_k_list </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *&#160;</td>
          <td class="paramname"><em>ppt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>K</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This routine infers from the q values a list of corresponding k values for each mode.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppt</td><td>Input: pointer to perturbation structure </td></tr>
    <tr><td class="paramname">ptr</td><td>Input/Output: pointer to transfer structure containing q's </td></tr>
    <tr><td class="paramname">K</td><td>Input: spatial curvature </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>

</div>
</div>
<a id="a44fe362b3b3d5cb7c2cf2ee5cf6a4267"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44fe362b3b3d5cb7c2cf2ee5cf6a4267">&#9670;&nbsp;</a></span>transfer_get_source_correspondence()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_get_source_correspondence </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *&#160;</td>
          <td class="paramname"><em>ppt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&#160;</td>
          <td class="paramname"><em>tp_of_tt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This routine defines the correspondence between the sources in the perturbation and transfer module.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppt</td><td>Input: pointer to perturbation structure </td></tr>
    <tr><td class="paramname">ptr</td><td>Input: pointer to transfer structure containing l's </td></tr>
    <tr><td class="paramname">tp_of_tt</td><td>Input/Output: array with the correspondence (allocated before, filled here) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<ul>
<li>running index on modes</li>
<li>running index on transfer types</li>
<li>which source are we considering? Define correspondence between transfer types and source types</li>
</ul>

</div>
</div>
<a id="a5ed3e182de457eab4dd07251e8ae7e4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ed3e182de457eab4dd07251e8ae7e4d">&#9670;&nbsp;</a></span>transfer_source_tau_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_source_tau_size </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="background_8h.html#structbackground">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *&#160;</td>
          <td class="paramname"><em>ppt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tau_rec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tau0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_md</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_tt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>tau_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>the code makes a distinction between "perturbation sources" (e.g. gravitational potential) and "transfer sources" (e.g. total density fluctuations, obtained through the Poisson equation, and observed with a given selection function).</p>
<p>This routine computes the number of sampled time values for each type of transfer sources.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppr</td><td>Input: pointer to precision structure </td></tr>
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">ppt</td><td>Input: pointer to perturbation structure </td></tr>
    <tr><td class="paramname">ptr</td><td>Input: pointer to transfer structure </td></tr>
    <tr><td class="paramname">tau_rec</td><td>Input: recombination time </td></tr>
    <tr><td class="paramname">tau0</td><td>Input: time today </td></tr>
    <tr><td class="paramname">index_md</td><td>Input: index of the mode (scalar, tensor) </td></tr>
    <tr><td class="paramname">index_tt</td><td>Input: index of transfer type </td></tr>
    <tr><td class="paramname">tau_size</td><td>Output: pointer to number of sampled times </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>

</div>
</div>
<a id="a4dadab78fbaa9c977ed4e5e7f507fc6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4dadab78fbaa9c977ed4e5e7f507fc6a">&#9670;&nbsp;</a></span>transfer_compute_for_each_q()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_compute_for_each_q </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="background_8h.html#structbackground">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *&#160;</td>
          <td class="paramname"><em>ppt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&#160;</td>
          <td class="paramname"><em>tp_of_tt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tau_size_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tau_rec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double ***&#160;</td>
          <td class="paramname"><em>pert_sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double ***&#160;</td>
          <td class="paramname"><em>pert_sources_spline</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>window</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfer__workspace">transfer_workspace</a> *&#160;</td>
          <td class="paramname"><em>ptw</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Summary:</p>
<ul>
<li>define local variables</li>
<li>we deal with workspaces, i.e. with contiguous memory zones (one per thread) containing various fields used by the integration routine</li>
<li>for a given l, maximum value of k such that we can convolve the source with Bessel functions j_l(x) without reaching x_max</li>
<li>store the sources in the workspace and define all fields in this workspace</li>
<li>loop over all modes. For each mode</li>
<li>loop over initial conditions.</li>
<li>check if we must now deal with a new source with a new index ppt-&gt;index_type. If yes, interpolate it at the right values of k.</li>
<li>Select radial function type</li>
</ul>

</div>
</div>
<a id="a5ba2dead90573339ccc54b63d8a58989"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ba2dead90573339ccc54b63d8a58989">&#9670;&nbsp;</a></span>transfer_interpolate_sources()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_interpolate_sources </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *&#160;</td>
          <td class="paramname"><em>ppt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_md</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_ic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>pert_source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>pert_source_spline</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>interpolated_sources</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This routine interpolates sources <img class="formulaInl" alt="$ S(k, \tau) $" src="form_71.png" width="36" height="14"/> for each mode, initial condition and type (of perturbation module), to get them at the right values of k, using the spline interpolation method.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppt</td><td>Input: pointer to perturbation structure </td></tr>
    <tr><td class="paramname">ptr</td><td>Input: pointer to transfer structure </td></tr>
    <tr><td class="paramname">index_q</td><td>Input: index of wavenumber </td></tr>
    <tr><td class="paramname">index_md</td><td>Input: index of mode </td></tr>
    <tr><td class="paramname">index_ic</td><td>Input: index of initial condition </td></tr>
    <tr><td class="paramname">index_type</td><td>Input: index of type of source (in perturbation module) </td></tr>
    <tr><td class="paramname">pert_source</td><td>Input: array of sources </td></tr>
    <tr><td class="paramname">pert_source_spline</td><td>Input: array of second derivative of sources </td></tr>
    <tr><td class="paramname">interpolated_sources</td><td>Output: array of interpolated sources (filled here but allocated in <a class="el" href="transfer_8c.html#a96f1a37539a8a452fa71ef3971909bb2">transfer_init()</a> to avoid numerous reallocation) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<ul>
<li>define local variables</li>
<li>interpolate at each k value using the usual spline interpolation algorithm.</li>
</ul>

</div>
</div>
<a id="a5d21f13ccec1a296e472efb7023f2d06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d21f13ccec1a296e472efb7023f2d06">&#9670;&nbsp;</a></span>transfer_sources()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_sources </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="background_8h.html#structbackground">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *&#160;</td>
          <td class="paramname"><em>ppt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>interpolated_sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tau_rec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_md</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_tt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>window</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tau_size_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>tau0_minus_tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>w_trapz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>tau_size_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The code makes a distinction between "perturbation sources" (e.g. gravitational potential) and "transfer sources" (e.g. total density fluctuations, obtained through the Poisson equation, and observed with a given selection function).</p>
<p>This routine computes the transfer source given the interpolated perturbation source, and copies it in the workspace.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppr</td><td>Input: pointer to precision structure </td></tr>
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">ppt</td><td>Input: pointer to perturbation structure </td></tr>
    <tr><td class="paramname">ptr</td><td>Input: pointer to transfer structure </td></tr>
    <tr><td class="paramname">interpolated_sources</td><td>Input: interpolated perturbation source </td></tr>
    <tr><td class="paramname">tau_rec</td><td>Input: recombination time </td></tr>
    <tr><td class="paramname">index_q</td><td>Input: index of wavenumber </td></tr>
    <tr><td class="paramname">index_md</td><td>Input: index of mode </td></tr>
    <tr><td class="paramname">index_tt</td><td>Input: index of type of (transfer) source </td></tr>
    <tr><td class="paramname">sources</td><td>Output: transfer source </td></tr>
    <tr><td class="paramname">window</td><td>Input: window functions for each type and time </td></tr>
    <tr><td class="paramname">tau_size_max</td><td>Input: number of times at wich window fucntions are sampled </td></tr>
    <tr><td class="paramname">tau0_minus_tau</td><td>Output: values of (tau0-tau) at which source are sample </td></tr>
    <tr><td class="paramname">w_trapz</td><td>Output: trapezoidal weights for integration over tau </td></tr>
    <tr><td class="paramname">tau_size_out</td><td>Output: pointer to size of previous two arrays, converted to double </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<ul>
<li>define local variables</li>
<li>in which cases are perturbation and transfer sources are different? I.e., in which case do we need to multiply the sources by some background and/or window function, and eventually to resample it, or redefine its time limits?</li>
<li>case where we need to redefine by a window function (or any function of the background and of k)</li>
<li>case where we do not need to redefine</li>
<li>return tau_size value that will be stored in the workspace (the workspace wants a double)</li>
</ul>

</div>
</div>
<a id="ad91b311d6f1a765f1346a0ded531f4c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad91b311d6f1a765f1346a0ded531f4c8">&#9670;&nbsp;</a></span>transfer_selection_function()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_selection_function </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *&#160;</td>
          <td class="paramname"><em>ppt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>selection</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Arbitrarily normalized selection function dN/dz(z,bin)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppr</td><td>Input: pointer to precision structure </td></tr>
    <tr><td class="paramname">ppt</td><td>Input: pointer to perturbation structure </td></tr>
    <tr><td class="paramname">ptr</td><td>Input: pointer to transfer structure </td></tr>
    <tr><td class="paramname">bin</td><td>Input: redshift bin number </td></tr>
    <tr><td class="paramname">z</td><td>Input: one value of redshift </td></tr>
    <tr><td class="paramname">selection</td><td>Output: pointer to selection function </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>

</div>
</div>
<a id="a75d06ef89c95bc798cdab8f1ca6d0426"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75d06ef89c95bc798cdab8f1ca6d0426">&#9670;&nbsp;</a></span>transfer_dNdz_analytic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_dNdz_analytic </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>dNdz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>dln_dNdz_dz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Analytic form for dNdz distribution, from arXiv:1004.4640</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ptr</td><td>Input: pointer to transfer structure </td></tr>
    <tr><td class="paramname">z</td><td>Input: redshift </td></tr>
    <tr><td class="paramname">dNdz</td><td>Output: density per redshift, dN/dZ </td></tr>
    <tr><td class="paramname">dln_dNdz_dz</td><td>Output: dln(dN/dz)/dz, used optionally for the source evolution </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>

</div>
</div>
<a id="a651dd7133c0206ffe6ae145718efe19b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a651dd7133c0206ffe6ae145718efe19b">&#9670;&nbsp;</a></span>transfer_selection_sampling()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_selection_sampling </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="background_8h.html#structbackground">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *&#160;</td>
          <td class="paramname"><em>ppt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>tau0_minus_tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tau_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>For sources that need to be multiplied by a selection function, redefine a finer time sampling in a small range</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppr</td><td>Input: pointer to precision structure </td></tr>
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">ppt</td><td>Input: pointer to perturbation structure </td></tr>
    <tr><td class="paramname">ptr</td><td>Input: pointer to transfer structure </td></tr>
    <tr><td class="paramname">bin</td><td>Input: redshift bin number </td></tr>
    <tr><td class="paramname">tau0_minus_tau</td><td>Output: values of (tau0-tau) at which source are sample </td></tr>
    <tr><td class="paramname">tau_size</td><td>Output: pointer to size of previous array </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>

</div>
</div>
<a id="ac837fa21a9bc43da13eca67cb6f48539"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac837fa21a9bc43da13eca67cb6f48539">&#9670;&nbsp;</a></span>transfer_lensing_sampling()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_lensing_sampling </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="background_8h.html#structbackground">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *&#160;</td>
          <td class="paramname"><em>ppt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tau0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>tau0_minus_tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tau_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>For lensing sources that need to be convolved with a selection function, redefine the sampling within the range extending from the tau_min of the selection function up to tau0</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppr</td><td>Input: pointer to precision structure </td></tr>
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">ppt</td><td>Input: pointer to perturbation structure </td></tr>
    <tr><td class="paramname">ptr</td><td>Input: pointer to transfer structure </td></tr>
    <tr><td class="paramname">bin</td><td>Input: redshift bin number </td></tr>
    <tr><td class="paramname">tau0</td><td>Input: time today </td></tr>
    <tr><td class="paramname">tau0_minus_tau</td><td>Output: values of (tau0-tau) at which source are sample </td></tr>
    <tr><td class="paramname">tau_size</td><td>Output: pointer to size of previous array </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>

</div>
</div>
<a id="ad370b084d1580c8dc159b1c71d7d4e54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad370b084d1580c8dc159b1c71d7d4e54">&#9670;&nbsp;</a></span>transfer_source_resample()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_source_resample </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="background_8h.html#structbackground">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *&#160;</td>
          <td class="paramname"><em>ppt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>tau0_minus_tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tau_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_md</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tau0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>interpolated_sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>sources</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>For sources that need to be multiplied by a selection function, redefine a finer time sampling in a small range, and resample the perturbation sources at the new value by linear interpolation</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppr</td><td>Input: pointer to precision structure </td></tr>
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">ppt</td><td>Input: pointer to perturbation structure </td></tr>
    <tr><td class="paramname">ptr</td><td>Input: pointer to transfer structure </td></tr>
    <tr><td class="paramname">bin</td><td>Input: redshift bin number </td></tr>
    <tr><td class="paramname">tau0_minus_tau</td><td>Output: values of (tau0-tau) at which source are sample </td></tr>
    <tr><td class="paramname">tau_size</td><td>Output: pointer to size of previous array </td></tr>
    <tr><td class="paramname">index_md</td><td>Input: index of mode </td></tr>
    <tr><td class="paramname">tau0</td><td>Input: time today </td></tr>
    <tr><td class="paramname">interpolated_sources</td><td>Input: interpolated perturbation source </td></tr>
    <tr><td class="paramname">sources</td><td>Output: resampled transfer source </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>

</div>
</div>
<a id="a93bc176ac659dad26e2badd12145d572"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93bc176ac659dad26e2badd12145d572">&#9670;&nbsp;</a></span>transfer_selection_times()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_selection_times </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="background_8h.html#structbackground">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *&#160;</td>
          <td class="paramname"><em>ppt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>tau_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>tau_mean</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>tau_max</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>For each selection function, compute the min, mean and max values of conformal time (associated to the min, mean and max values of redshift specified by the user)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppr</td><td>Input: pointer to precision structure </td></tr>
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">ppt</td><td>Input: pointer to perturbation structure </td></tr>
    <tr><td class="paramname">ptr</td><td>Input: pointer to transfer structure </td></tr>
    <tr><td class="paramname">bin</td><td>Input: redshift bin number </td></tr>
    <tr><td class="paramname">tau_min</td><td>Output: smallest time in the selection interval </td></tr>
    <tr><td class="paramname">tau_mean</td><td>Output: time corresponding to z_mean </td></tr>
    <tr><td class="paramname">tau_max</td><td>Output: largest time in the selection interval </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>

</div>
</div>
<a id="af896822157edf6f646a70e9cf558c554"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af896822157edf6f646a70e9cf558c554">&#9670;&nbsp;</a></span>transfer_selection_compute()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_selection_compute </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="background_8h.html#structbackground">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *&#160;</td>
          <td class="paramname"><em>ppt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>selection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>tau0_minus_tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>w_trapz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tau_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>pvecback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tau0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute and normalize selection function for a set of time values</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppr</td><td>Input: pointer to precision structure </td></tr>
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">ppt</td><td>Input: pointer to perturbation structure </td></tr>
    <tr><td class="paramname">ptr</td><td>Input: pointer to transfer structure </td></tr>
    <tr><td class="paramname">selection</td><td>Output: normalized selection function </td></tr>
    <tr><td class="paramname">tau0_minus_tau</td><td>Input: values of (tau0-tau) at which source are sample </td></tr>
    <tr><td class="paramname">w_trapz</td><td>Input: trapezoidal weights for integration over tau </td></tr>
    <tr><td class="paramname">tau_size</td><td>Input: size of previous two arrays </td></tr>
    <tr><td class="paramname">pvecback</td><td>Input: allocated array of background values </td></tr>
    <tr><td class="paramname">tau0</td><td>Input: time today </td></tr>
    <tr><td class="paramname">bin</td><td>Input: redshift bin number </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>

</div>
</div>
<a id="a1874eaa8665d73548229b64972765cc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1874eaa8665d73548229b64972765cc5">&#9670;&nbsp;</a></span>transfer_compute_for_each_l()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_compute_for_each_l </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfer__workspace">transfer_workspace</a> *&#160;</td>
          <td class="paramname"><em>ptw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *&#160;</td>
          <td class="paramname"><em>ppt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_md</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_ic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_tt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>q_max_bessel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="transfer_8h.html#af3f4670b8918a9905edf8d0c2c5ce32b">radial_function_type</a>&#160;</td>
          <td class="paramname"><em>radial_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This routine computes the transfer functions <img class="formulaInl" alt="$ \Delta_l^{X} (k) $" src="form_293.png" width="35" height="15"/>) as a function of wavenumber k for a given mode, initial condition, type and multipole l passed in input.</p>
<p>For a given value of k, the transfer function is inferred from the source function (passed in input in the array interpolated_sources) and from Bessel functions (passed in input in the bessels structure), either by convolving them along tau, or by a Limber approximation. This elementary task is distributed either to <a class="el" href="transfer_8c.html#a6122e71134ade9774074a3f722f1f3f5">transfer_integrate()</a> or to <a class="el" href="transfer_8c.html#a9858d7e498a713479d1243456afc74ae">transfer_limber()</a>. The task of this routine is mainly to loop over k values, and to decide at which k_max the calculation can be stopped, according to some approximation scheme designed to find a compromise between execution time and precision. The approximation scheme is defined by parameters in the precision structure.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ptw</td><td>Input: pointer to <a class="el" href="transfer_8h.html#structtransfer__workspace">transfer_workspace</a> structure (allocated in <a class="el" href="transfer_8c.html#a96f1a37539a8a452fa71ef3971909bb2">transfer_init()</a> to avoid numerous reallocation) </td></tr>
    <tr><td class="paramname">ppr</td><td>Input: pointer to precision structure </td></tr>
    <tr><td class="paramname">ppt</td><td>Input: pointer to perturbation structure </td></tr>
    <tr><td class="paramname">ptr</td><td>Input/output: pointer to transfer structure (result stored there) </td></tr>
    <tr><td class="paramname">index_q</td><td>Input: index of wavenumber </td></tr>
    <tr><td class="paramname">index_md</td><td>Input: index of mode </td></tr>
    <tr><td class="paramname">index_ic</td><td>Input: index of initial condition </td></tr>
    <tr><td class="paramname">index_tt</td><td>Input: index of type of transfer </td></tr>
    <tr><td class="paramname">index_l</td><td>Input: index of multipole </td></tr>
    <tr><td class="paramname">l</td><td>Input: multipole </td></tr>
    <tr><td class="paramname">q_max_bessel</td><td>Input: maximum value of argument q at which Bessel functions are computed </td></tr>
    <tr><td class="paramname">radial_type</td><td>Input: type of radial (Bessel) functions to convolve with </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<ul>
<li>define local variables</li>
<li>return zero transfer function if l is above l_max</li>
<li>store transfer function in transfer structure</li>
</ul>
<div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="transfer_8c_a1874eaa8665d73548229b64972765cc5_cgraph.png" border="0" usemap="#atransfer_8c_a1874eaa8665d73548229b64972765cc5_cgraph" alt=""/></div>
<map name="atransfer_8c_a1874eaa8665d73548229b64972765cc5_cgraph" id="atransfer_8c_a1874eaa8665d73548229b64972765cc5_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,151,47"/>
<area shape="rect" href="transfer_8h.html#ae9cf755fe7932a83d3e44c67f59a3c3f" title=" " alt="" coords="199,13,317,39"/>
</map>
</div>

</div>
</div>
<a id="a6122e71134ade9774074a3f722f1f3f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6122e71134ade9774074a3f722f1f3f5">&#9670;&nbsp;</a></span>transfer_integrate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_integrate </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *&#160;</td>
          <td class="paramname"><em>ppt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfer__workspace">transfer_workspace</a> *&#160;</td>
          <td class="paramname"><em>ptw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_md</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_tt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="transfer_8h.html#af3f4670b8918a9905edf8d0c2c5ce32b">radial_function_type</a>&#160;</td>
          <td class="paramname"><em>radial_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>trsf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This routine computes the transfer functions <img class="formulaInl" alt="$ \Delta_l^{X} (k) $" src="form_293.png" width="35" height="15"/>) for each mode, initial condition, type, multipole l and wavenumber k, by convolving the source function (passed in input in the array interpolated_sources) with Bessel functions (passed in input in the bessels structure).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppt</td><td>Input: pointer to perturbation structure </td></tr>
    <tr><td class="paramname">ptr</td><td>Input: pointer to transfer structure </td></tr>
    <tr><td class="paramname">ptw</td><td>Input: pointer to <a class="el" href="transfer_8h.html#structtransfer__workspace">transfer_workspace</a> structure (allocated in <a class="el" href="transfer_8c.html#a96f1a37539a8a452fa71ef3971909bb2">transfer_init()</a> to avoid numerous reallocation) </td></tr>
    <tr><td class="paramname">index_q</td><td>Input: index of wavenumber </td></tr>
    <tr><td class="paramname">index_md</td><td>Input: index of mode </td></tr>
    <tr><td class="paramname">index_tt</td><td>Input: index of type </td></tr>
    <tr><td class="paramname">l</td><td>Input: multipole </td></tr>
    <tr><td class="paramname">index_l</td><td>Input: index of multipole </td></tr>
    <tr><td class="paramname">k</td><td>Input: wavenumber </td></tr>
    <tr><td class="paramname">radial_type</td><td>Input: type of radial (Bessel) functions to convolve with </td></tr>
    <tr><td class="paramname">trsf</td><td>Output: transfer function <img class="formulaInl" alt="$ \Delta_l(k) $" src="form_294.png" width="30" height="14"/> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<ul>
<li>define local variables</li>
<li>find minimum value of (tau0-tau) at which <img class="formulaInl" alt="$ j_l(k[\tau_0-\tau]) $" src="form_295.png" width="66" height="14"/> is known, given that <img class="formulaInl" alt="$ j_l(x) $" src="form_296.png" width="26" height="14"/> is sampled above some finite value <img class="formulaInl" alt="$ x_{\min} $" src="form_297.png" width="25" height="9"/> (below which it can be approximated by zero)</li>
<li>if there is no overlap between the region in which bessels and sources are non-zero, return zero</li>
<li>if there is an overlap:</li>
<li>--&gt; trivial case: the source is a Dirac function and is sampled in only one point</li>
<li>--&gt; other cases</li>
<li>&mdash;&gt; (a) find index in the source's tau list corresponding to the last point in the overlapping region. After this step, index_tau_max can be as small as zero, but not negative.</li>
<li>&mdash;&gt; (b) the source function can vanish at large <img class="formulaInl" alt="$ \tau $" src="form_43.png" width="8" height="6"/>. Check if further points can be eliminated. After this step and if we did not return a null transfer function, index_tau_max can be as small as zero, but not negative.</li>
<li>Compute the radial function:</li>
<li>Now we do most of the convolution integral:</li>
<li>This integral is correct for the case where no truncation has occurred. If it has been truncated at some index_tau_max because f[index_tau_max+1]==0, it is still correct. The 'mistake' in using the wrong weight w_trapz[index_tau_max] is exactly compensated by the triangle we miss. However, for the Bessel cut off, we must subtract the wrong triangle and add the correct triangle.</li>
</ul>

</div>
</div>
<a id="a9858d7e498a713479d1243456afc74ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9858d7e498a713479d1243456afc74ae">&#9670;&nbsp;</a></span>transfer_limber()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_limber </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfer__workspace">transfer_workspace</a> *&#160;</td>
          <td class="paramname"><em>ptw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_md</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="transfer_8h.html#af3f4670b8918a9905edf8d0c2c5ce32b">radial_function_type</a>&#160;</td>
          <td class="paramname"><em>radial_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>trsf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This routine computes the transfer functions <img class="formulaInl" alt="$ \Delta_l^{X} (k) $" src="form_293.png" width="35" height="15"/>) for each mode, initial condition, type, multipole l and wavenumber k, by using the Limber approximation, i.e by evaluating the source function (passed in input in the array interpolated_sources) at a single value of tau (the Bessel function being approximated as a Dirac distribution).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ptr</td><td>Input: pointer to transfer structure </td></tr>
    <tr><td class="paramname">ptw</td><td>Input: pointer to transfer workspace structure </td></tr>
    <tr><td class="paramname">index_md</td><td>Input: index of mode </td></tr>
    <tr><td class="paramname">index_q</td><td>Input: index of wavenumber </td></tr>
    <tr><td class="paramname">l</td><td>Input: multipole </td></tr>
    <tr><td class="paramname">q</td><td>Input: wavenumber </td></tr>
    <tr><td class="paramname">radial_type</td><td>Input: type of radial (Bessel) functions to convolve with </td></tr>
    <tr><td class="paramname">trsf</td><td>Output: transfer function <img class="formulaInl" alt="$ \Delta_l(k) $" src="form_294.png" width="30" height="14"/> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<ul>
<li>define local variables</li>
<li>get k, l and infer tau such that k(tau0-tau)=l+1/2; check that tau is in appropriate range</li>
<li>get transfer = source * <img class="formulaInl" alt="$ \sqrt{\pi/(2l+1)}/q $" src="form_298.png" width="80" height="16"/> = source*[tau0-tau] * <img class="formulaInl" alt="$ \sqrt{\pi/(2l+1)}/(l+1/2)$" src="form_299.png" width="120" height="16"/></li>
</ul>

</div>
</div>
<a id="a0708236ad3535c319b9ca9c055f96615"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0708236ad3535c319b9ca9c055f96615">&#9670;&nbsp;</a></span>transfer_limber_interpolate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_limber_interpolate </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>tau0_minus_tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tau_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tau0_minus_tau_limber</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>S</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<ul>
<li>find bracketing indices. index_tau must be at least 1 (so that index_tau-1 is at least 0) and at most tau_size-2 (so that index_tau+1 is at most tau_size-1).</li>
<li>interpolate by fitting a polynomial of order two; get source and its first two derivatives. Note that we are not interpolating S, but the product S*(tau0-tau). Indeed this product is regular in tau=tau0, while S alone diverges for lensing.</li>
</ul>

</div>
</div>
<a id="a796ce542bdd1305b6ee679e0836471b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a796ce542bdd1305b6ee679e0836471b9">&#9670;&nbsp;</a></span>transfer_limber2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_limber2 </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tau_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_md</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>tau0_minus_tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>sources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="transfer_8h.html#af3f4670b8918a9905edf8d0c2c5ce32b">radial_function_type</a>&#160;</td>
          <td class="paramname"><em>radial_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>trsf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This routine computes the transfer functions <img class="formulaInl" alt="$ \Delta_l^{X} (k) $" src="form_293.png" width="35" height="15"/>) for each mode, initial condition, type, multipole l and wavenumber k, by using the Limber approximation at order two, i.e as a function of the source function and its first two derivatives at a single value of tau</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tau_size</td><td>Input: size of conformal time array </td></tr>
    <tr><td class="paramname">ptr</td><td>Input: pointer to transfer structure </td></tr>
    <tr><td class="paramname">index_md</td><td>Input: index of mode </td></tr>
    <tr><td class="paramname">index_k</td><td>Input: index of wavenumber </td></tr>
    <tr><td class="paramname">l</td><td>Input: multipole </td></tr>
    <tr><td class="paramname">k</td><td>Input: wavenumber </td></tr>
    <tr><td class="paramname">tau0_minus_tau</td><td>Input: array of values of (tau_today - tau) </td></tr>
    <tr><td class="paramname">sources</td><td>Input: source functions </td></tr>
    <tr><td class="paramname">radial_type</td><td>Input: type of radial (Bessel) functions to convolve with </td></tr>
    <tr><td class="paramname">trsf</td><td>Output: transfer function <img class="formulaInl" alt="$ \Delta_l(k) $" src="form_294.png" width="30" height="14"/> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<ul>
<li>define local variables</li>
<li>get k, l and infer tau such that k(tau0-tau)=l+1/2; check that tau is in appropriate range</li>
<li>find bracketing indices</li>
<li>interpolate by fitting a polynomial of order two; get source and its first two derivatives</li>
<li>get transfer from 2nd order Limber approx (inferred from 0809.5112 [astro-ph])</li>
</ul>

</div>
</div>
<a id="ad72ae14480a39fa4db9a33e48ccb206f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad72ae14480a39fa4db9a33e48ccb206f">&#9670;&nbsp;</a></span>transfer_precompute_selection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_precompute_selection </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="common_8h.html#structprecision">precision</a> *&#160;</td>
          <td class="paramname"><em>ppr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="background_8h.html#structbackground">background</a> *&#160;</td>
          <td class="paramname"><em>pba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="perturbations_8h.html#structperturbations">perturbations</a> *&#160;</td>
          <td class="paramname"><em>ppt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="transfer_8h.html#structtransfer">transfer</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tau_rec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tau_size_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>window</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Here we can precompute the window functions for the final integration For each type of nCl/dCl/sCl we combine the selection function with the corresponding prefactor (e.g. 1/aH), and, if required, we also integrate for integrated (lensed) contributions (In the original ClassGAL paper these would be labeled g4,g5, and lens)</p>
<p>All factors of k have to be added later (at least in the current version)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ppr</td><td>Input: pointer to precision structure </td></tr>
    <tr><td class="paramname">pba</td><td>Input: pointer to background structure </td></tr>
    <tr><td class="paramname">ppt</td><td>Input: pointer to perturbation structure </td></tr>
    <tr><td class="paramname">ptr</td><td>Input: pointer to transfer structure </td></tr>
    <tr><td class="paramname">tau_rec</td><td>Input: recombination time </td></tr>
    <tr><td class="paramname">tau_size_max</td><td>Input: maximum size that tau array can have </td></tr>
    <tr><td class="paramname">window</td><td>Output: pointer to array of selection functions </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the error status </dd></dl>
<p>Summary:</p>
<ul>
<li>define local variables</li>
</ul>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="transfer_8c.html">transfer.c</a></li>
    <li class="footer">Generated on Wed Sep 29 2021 16:27:42 for CLASS MANUAL by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
